KISSY.add(function(f){var x=f.DOM,k=f.Event,A=f.Node,l="menu-item-active",v="menu-minus",h="menu-tag",n="menu-plus",q="menu-container",p="menu-ul",C="ks-clear",o="menu-li",r="menu-item",B="menu_sp",s="menu-ul-next",c="menu-ul-next-close",w="menu-item-next",b="menu-p-lf",j="menu-p-rt",g="menu-p-content",u="data-item",i="menu-item-",e="menu-item-next_",y="\u5bf9\u4e0d\u8d77,\u7ed1\u5b9a\u65f6\uff0c\u627e\u4e0d\u5230\u7ed1\u5b9a\u8282\u70b9.",m="\u5bf9\u4e0d\u8d77\uff0c\u4f60\u8bbe\u7f6e\u7684\u5bbd\u5ea6\u4e0d\u662f\u6b63\u786e\u7684\u503c\uff01",d="\u5bf9\u4e0d\u8d77\uff0c\u4f60\u8bbe\u7f6e\u7684\u9ad8\u5ea6\u4e0d\u662f\u6b63\u786e\u7684\u503c\uff01",t=100,D=45,z=55;var a=function(G){var F={collapsible:true,items:[],renderTo:"body"};var E=this;var H=f.merge(F,G);a.superclass.constructor.call(E,H);f.mix(E,H);E._init()};f.extend(a,f.Base);f.augment(a,{msg:"Loading...",NOT_FOUND_TAB:"\u5bf9\u4e0d\u8d77\uff0c\u627e\u4e0d\u5230\u914d\u5957\u4f7f\u7528\u7684Tab\u5361\u5bf9\u8c61",TAB_FUNCTION_ERROR:"\u5bf9\u4e0d\u8d77\uff0c\u8c03\u7528tab\u51fd\u6570\u51fa\u9519\uff01",_html:function(){var E=this;var J=f.one(E.renderTo);if(J===null){E.exception(y);return}E.set("container",J);if(E.items.length!==0){var I='<div class="'+q+'"><ul class="'+p+" "+C+'"></ul></div>';var H=new A(I).appendTo(J),K=H.children("ul"),F=E.items;for(var G=0;G<F.length;G++){E._createMenuItem(F[G],K)}x.css("."+r,{cursor:"pointer"});x.css("."+h,{cursor:"pointer"})}},_createMenuItem:function(O,N){if(!O){return}var L=this,E="",I="",M=null;if(O.id){E=i+O.id}else{E=i+f.guid();f.log("auto set id for  item")}var J="";if(O.isOpen===false){J=v}else{J=n}I+='<li class="'+o+'"><p class="'+r+'" id="'+E+'" ><span class="'+J+" "+h+'"></span>'+O.text||"</p> ";I+='<div class="'+B+'"></div>';I+="</li>";M=new A(I).appendTo(N);M.data(u,O);if(O.items){var H="";if(O.isOpen===false){H='<ul class="'+s+" "+c+'" ></ul>'}else{H='<ul class="'+s+'" ></ul>'}var F=new A(H).appendTo(M);if(O.items.length!==0){var K=O.items;for(var G=0;G<K.length;G++){L._createSubMenuItem(K[G],F)}}}return M},_createSubMenuItem:function(H,G){if(!H){return}var I="",F="";if(H.id){I=e+H.id}else{I=e+f.guid()}F+='<li ><a class="'+w+'" id="'+I+'" href="'+(H.href===undefined?"#":H.href)+'"><em class="'+b+'"></em><em class="'+g+'">'+H.text+'</em><em class="'+j+'"></em></a></li>';var E=new A(F).appendTo(G);E.data(u,H)},_setUI:function(){var E=this,H=/^\d{0,10}$/;if(E.height){var G=E.height.replace("px","");if(G!==""){if(G.match(H)===null){E.exception(d)}else{x.css(".menu-container",{height:G+"px"})}}}if(E.width){var F=E.width.replace("px","");if(F!==""){if(F.match(H)===null){E.exception(m)}else{var I=parseInt(F);if(I<t){F=t;x.css("."+g,{width:D+"px"})}else{x.css("."+g,{width:(I-z)+"px"})}x.css("."+q,{width:F+"px"})}}}},_setCollapible:function(){var E=this;if(E.collapible){var F=E.get("container");F.all("."+r).on("click",function(H){var G=this;H.preventDefault();var I=x.siblings(G)[1],J=x.children(G)[0];if(x.css(I,"display")==="block"){x.css(I,{display:"none"})}else{x.css(I,{display:"block"})}if(x.attr(J,"class")===v+" "+h){x.attr(J,"class",n+" "+h)}else{x.attr(J,"class",v+" "+h)}});F.all("."+h).on("click",function(H){var G=this;if(x.siblings(x.parent(G)).length>1){var I=x.siblings(x.parent(G))[1];if(x.css(I,"display")==="block"){x.css(I,{display:"none"})}else{x.css(I,{display:"block"})}}if(x.attr(G,"class")===v+" "+h){x.attr(G,"class",n+" "+h)}else{x.attr(G,"class",v+" "+h)}H.stopPropagation()})}},_setTabEvent:function(){var E=this,F=E.get("container");F.all("."+w).on("click",function(I){var H=this;I.preventDefault();var L=x.attr(this,"id"),K=L.replace(L.split("_")[0]+"_",""),J=x.text(this),G=x.attr(this,"href");E.fire("menuclick",{text:J,id:K,href:G});if(x.attr(this,"class")===w){E.setMenuActive(K)}H.blur()})},_setNextItemFontEvent:function(){var E=this,F=E.get("container");F.all("."+w).on("mouseover",function(){x.css(this,{color:"#FF6600"})});F.all("."+w).on("mouseleave",function(){x.css(this,{color:"#263E74"})})},getSelectedItem:function(){var E=this,H=E.get("container"),I=H.one("."+l);if(!I){return null}var F=I.parent(),G=F.data(u);return G},setMenuActive:function(K){var E=this,G=E.get("container");if(K==="none"){x.replaceClass(G.all("."+l),l,w);x.css(G.all("."+w),{color:"#263E74"});return}var I=x.parent(x.parent("#"+e+K));if(!I){return}if(x.css(I,"display")==="none"){var J=x.children(x.siblings(I)[0])[0];x.attr(J,"class",n);x.css(I,{display:"block"})}var F=x.attr("#"+e+K,"href");var H=x.text("#"+e+K);E.fire("selectchanged",{text:H,id:K,href:F});x.replaceClass(G.all("."+l),l,w);x.replaceClass("#"+e+K,w,l);x.css(G.all("."+w),{color:"#263E74"});x.css(G.all("."+l),{color:"#fff"});G.all("."+l).on("mouseover",function(){var L=this;if(x.attr(L,"class")===w){x.css(L,{color:"#FF6600"})}else{x.css(L,{color:"#fff"})}});G.all("."+l).on("mouseleave",function(){var L=this;if(x.attr(L,"class")===w){x.css(L,{color:"#263E74"})}else{x.css(L,{color:"#fff"})}})},exception:function(E){f.log(E)},_initDom:function(){var E=this;E._html();E._setUI()},_initEvent:function(){var E=this;E._setNextItemFontEvent();E._setCollapible();E._setTabEvent()},_init:function(){var E=this;E._initDom();E._initEvent()}});f.namespace("LP");f.LP.Menu=a},{requires:["core","./uicommon"]});
