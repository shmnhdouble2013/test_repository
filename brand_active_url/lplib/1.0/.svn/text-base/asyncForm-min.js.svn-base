KISSY.add(function(b){var c=b.DOM,a=b.Event;var e="i_frame";function d(g){var f=this;if(!(f instanceof d)){return new d(g)}g=g||{};if(!g.formId||!b.one("#"+g.formId)){throw"please assign the id of form!"}d.superclass.constructor.call(f,g);f._init()}b.extend(d,b.Base);b.augment(d,{_isInitLoad:false,_init:function(){var f=this,k=f.get("formId"),j=e+b.guid(),i=b.one("#"+k),h=['<iframe id="',j,'" name="',j,'" frameborder="0" src="" style="display:none"></iframe>'].join(""),g=b.Node(h).appendTo(document.body);i.attr("target",j);f.set("formEl",i);f.set("frameEl",g);f._initEvent()},_initEvent:function(){var f=this,g=f.get("formId");b.one("#"+g).on("submit",function(){if(!f._isInitLoad){f._isInitLoad=true;f._initLoadEvent()}})},_initLoadEvent:function(){var f=this,g=f.get("frameEl"),i=f.get("callback");function h(k){var m=g[0];var l=m.contentWindow.document,j=l.body||l.documentElement;if(i){i(j.innerHTML)}}g.on("load",h);f.set("frameEvent",h)},_destroy:function(){var f=this,g=f.get("frameEl"),h=f.get("frameEvent");a.remove(g[0],"load",h);g.remove();f.set("formEl",null);f.set("frameEl",null);f.set("frameEvent",null)}});b.namespace("LP");b.LP.AsyncForm=d;return d},{requires:["core"]});
