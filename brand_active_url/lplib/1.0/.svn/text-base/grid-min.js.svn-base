KISSY.add(function(k){var C=k.DOM,H=k.UA,z=k.Node,m=document,E="data-column-name",ad="data-column-field",Z="grid-header-th",V="grid-header-th-empty",p="grid-header-th-inner",U="grid-header-inner-title",l="grid-body-cell-text",h="grid-checkbox",L="grid-row",r="grid-row-selected",ai="grid-row-over",T="grid-body-cell",t="grid-body-cell-inner",f="hover",ae="ks-hidden",D="sortable",Q="sorted-asc",i="sorted-desc",aj="grid-row-odd",F="grid-row-even",n="grid-column-menu-trigger",d="grid-header-column-",u="row-element",ab=80,O=25,g=25,am=30,W=80,N=15,M="data-column",s="ks-active",c="grid-menu-item",Y="grid-column-menu-item",a="menu-item-checked",v="menu-item-unchecked",I="lp-item-disabled",q='<span class="menu-item-icon"/>',aa=148,al="col",o="grid-editable-cell",b="grid-dirty-cell",y="grid-error-cell",A="grid-cell-error-icon",K="grid-body-td-",ac="grid-error-editor",w="grid-error-editor-icon",G=13,e=27,R=9;function J(an){var S=this;an=an||{};if(!an.renderTo){throw"please assign the id of rendered Dom!"}an=k.merge(J.config,an);J.superclass.constructor.call(S,an);S.events=["beginappend","afterappend","beginshow","aftershow","rowremoved","rowcreated","beforepagechange","rowclick","cellclick","rowdblclick","celldblclick","rowselected","rowunselected","rowselectchanged"];S._init()}J.config={showMenu:false};k.extend(J,k.Base);k.augment(J,{set:function(S,an){J.superclass.set.call(this,S,an,{silent:1})},appendData:function(ap){var S=this,ao=[],an=S._getRowCount();S.fire("beginappend",{data:ap});k.each(ap,function(ar,aq){var at=S._createRow(ar,an+aq);ao.push(at)});S.fire("afterappend",{rows:ao,data:ap})},addSummary:function(an){var S=this,ao=S.get("tfoot");k.all(ao.rows).remove();this._createSummaryRow(an)},clearData:function(){var an=this,S=an.get("tbody"),ao=S.rows;an._setHeaderChecked(false);k.each(ao,function(ap){an.fire("rowremoved",{data:C.data(ap,u),row:ap})});k.all(ao).remove()},clearSelection:function(){this._setAllRowsSelected(false)},filter:function(ar,aq){var an=this,S=an.get("tbody"),ap=k.makeArray(S.rows),ao=typeof aq==="function"?aq:function(at){return at===aq};k.each(ap,function(av){var at=k.one(av),au=C.data(av,u);if(aq===null){at.show()}else{if(!au||!ao(au[ar])){at.hide()}else{at.show()}}})},getWidth:function(){var S=this;return S.get("width")||S.get("gridEl").width()},getSelection:function(){var S=this,an=S.get("tbody"),ao=k.all("."+r,an),ap=[];k.each(ao,function(ar){var aq=C.data(ar,u);if(aq){ap.push(aq)}});return ap},getSelected:function(){var S=this,an=S.get("tbody"),ao=k.one("."+r,an);return ao?C.data(ao,u):null},hideColumn:function(S){this._setColumnVisible(S,false)},setAllSelection:function(){this._setAllRowsSelected(true)},setSelection:function(aq,an){var S=this,ao=S.get("tbody"),ap=ao.rows;k.each(ap,function(at){var ar=C.data(at,u);if(ar&&k.inArray(ar[aq],an)){S._setRowSelected(at,true)}})},setHeight:function(ao){var an=this,aq=an.get("gridEl"),ar=O,S=an.get("body"),ap=k.one(S);aq.height(ao);if(an.get("tbar")){ar+=(g+2);if(an.get("tbar").buttons){ar+=4}}if(an.get("bbar")){ar+=(g+2)}if(ao-ar>0){ap.height(ao-ar);ap.css("overflow-y","scroll")}},setWidth:function(an){var S=this;S.set("width",an);S._setWidth(an)},showColumn:function(S){this._setColumnVisible(S,true)},sort:function(ao,aq){var S=this,ap,an=S.get("store"),ar=k.isString(aq)?aq:(aq===1?"ASC":"DESC");if(typeof ao==="string"){ap=ao}else{ap=ao.dataIndex}if(an){an.sort(ap,ar)}else{S._localSort(ap,aq)}},showData:function(an){var S=this;S.fire("beginshow");S.clearData();k.each(an,function(ap,ao){S._createRow(ap,ao)});S._afterShow();S.fire("aftershow")},removeData:function(ap){var S=this,an=S.get("tbody"),ao=k.makeArray(an.rows);k.each(ao,function(ar){var aq=C.data(ar,u);if(aq&&k.inArray(aq,ap)){S.fire("rowremoved",{data:aq,row:ar});C.remove(ar)}})},_addBodyEvent:function(ap){var an=this,aq=an.get("head"),S=an.get("body"),ao=k.one(S);k.one(ap).on("click",function(ar){an._rowClickEvent(ar.target)}).on("mouseover",function(ar){an._rowOverEvent(ar.target)}).on("mouseout",function(ar){an._rowOutEvent(ar.target)}).on("dblclick",function(ar){an._rowDoubleClickEvent(ar.target)});ao.on("scroll",function(ar){var at=ao.scrollLeft();k.one(aq).scrollLeft(at)})},_afterShow:function(){var ap=this,at=ap.get("tbody"),ao=ap.get("body"),ar=k.one(ao),an,S,au,aq;if(H.ie===6||H.ie===7){an=ap.get("height");if(!an){S=ar.width();aq=ao.scrollWidth;if(aq>S){au=k.one(at).height();ar.height(au+17)}else{ar.css("height","auto")}}}},_createRow:function(aq,ap){var an=this,S=an.get("tbody"),au=an._getRowTemplate(ap,aq),ao=new z(au).appendTo(S),at=ao.getDOMNode(),ar=at.lastChild;C.data(at,u,aq);C.addClass(ar,"lp-last");an.fire("rowcreated",{data:aq,row:at});return ao},_createSummaryRow:function(ao){var S=this,ap=S.get("tfoot"),aq=S._getSummaryTemplate(ao),an=new z(aq).appendTo(ap);return an},_lookupByClass:function(an,S){if(C.hasClass(an,S)){return an}return C.parent(an,"."+S)},_findRowByRecord:function(ao){var an=this,ap=an.get("tbody"),aq=ap.rows,S=null;k.each(aq,function(at){var ar=C.data(at,u);if(ar===ao){S=at;return false}});return S},_findRow:function(S){return this._lookupByClass(S,L)},_findCell:function(S){return this._lookupByClass(S,T)},_getCell:function(ap,aq){var an=this,ar=an._findRowByRecord(ap),ao=K+aq,S=k.one("."+ao,ar);return S},_forceFitColumns:function(aq){var aw=this,au=aw.getWidth(),av=aw.get("height"),az=0,ao=0,ay=aw.get("checkable")?am+1:0,an=0,S=1,ax=0,at=0,ar=null,ap=0;aq=aq||aw.get("columns");at=aq.length;k.each(aq,function(aB){aB.width=aB.width||W;var aA=aB.originWidth||aB.width;if(!aB.hide){az+=aA;ao+=1}});an=ao*2+2+ay+(av?N+2:0);S=(au-an)/az;ax=0;if(S!==1){k.each(aq,function(aA){if(!aA.hide){aA.originWidth=aA.originWidth||aA.width;aA.width=Math.floor(aA.originWidth*S);ax+=aA.width;ar=aA}});ap=au-(ax+an);if(at&&ar){ar.width+=ap}}},_forceFitWidth:function(){var S=this,an=S.get("columns");S._forceFitColumns();k.each(an,function(ao){if(!ao.hide){S._setColumnWidth(ao)}})},_getRowCount:function(){var S=this,an=S.get("tbody");return k.all("."+L,an).length},_getCheckedCellTemplate:function(an,S){return['<td width="30px" align="center" class="',an," ",S,'"><div class="',S,'-inner"><span class="gwt-CheckBox"><input type="checkbox" class="',h,'" tabindex="0"></span></div></td>'].join("")},_getColumn:function(ap){var an=this,ao=an.get("columns"),S=null;k.each(ao,function(aq){if(aq.dataIndex===ap){S=aq;return false}});return S},_getColumnById:function(ap){var an=this,ao=an.get("columns"),S=null;k.each(ao,function(aq){if(aq.id===ap){S=aq;return false}});return S},_getHeadCell:function(aq){var an=this,ap=an.get("thead"),ao="."+d+aq,S=k.one(ao,ap);return S},_getRowTemplate:function(ar,ap){var at=this,av=at.get("columns"),ao=ar%2===0?aj:F,aq=[],au=null,aw=null,S="",an=at.get("checkable");if(an){aw=at._getCheckedCellTemplate("grid-row-checked-column",T);aq.push(aw)}k.each(av,function(ay,aA){var az=ap[ay.dataIndex],aB=ay.renderer?ay.renderer(az,ap):az,ax=at._getCellTemplate(aA,ay,aB,az,ap);aq.push(ax)});au=['<tr rowIndex="',ar,'" class="',L," ",ao,'">',aq.join(""),S,"</tr>"].join("");return au},_getSummaryTemplate:function(ar){var at=this,av=at.get("columns"),aq=[],ap=-1,ao=-1,au=null,an=at.get("checkable");if(an){ao+=1}function S(aw){if(aw>0){return'<td class="'+T+'" colspan="'+aw+'"></td>'}return""}k.each(av,function(ax,az){if(!ax.hide){ao+=1;if(ax.summary){aq.push(S(ao-ap-1));var ay=ar[ax.dataIndex],aA="\u603b\u8ba1\uff1a"+(ax.renderer?ax.renderer(ay,ar):ay),aw=at._getCellTemplate(az,ax,aA,ar);aq.push(aw);ap=ao}}});if(ap!==ao){aq.push(S(ao-ap))}au=['<tr class="',L,'">',aq.join(""),"</tr>"].join("");return au},_getCellTemplate:function(S,ao,ax,av,ap){var at=this,au=ao.dataIndex,an=ao.width,ar=at._getShowTip(ao,av,ap,true),aq=ao.hide?ae:"",aw=['<td  class="grid-body-cell grid-body-td-',ao.id," ",aq,'" data-column-name="',ao.id,'" colindex="',S,'" data-column-field = ',au,' width="',an,'px">','<div class="',t,'" style="width : ',an,'px"><span class="',l,' " ',ar,">",ax,"</span></div></td>"].join("");return aw},_getShowTip:function(an,aq,ar,S){var ao=an.showTip,at=aq,ap="";if(!ao){return""}if(k.isFunction(ao)){at=ao(aq,ar)}if(!!S){ap='title="'+(at||"")+'"'}else{ap=at||""}return ap},_getColumnsWidth:function(){var an=this,ap=an.get("columns"),ao=an.get("checkable"),S=0;if(ao){S+=31}k.each(ap,function(aq){if(!aq.hide){S+=aq.width+2}});return S},_init:function(){var av=this,ap=av.get("gridId"),S=av.get("container"),au=av.get("renderTo"),ao=null,aq=null,ar=null,aw=null,at=null,ay=null,an=0,ax=av.get("height");if(!S){S=C.get("#"+au);av.set("container",S)}if(!ap){ap=au+"grid";av.set("gridId",ap)}ao=['<div id="',ap,'" class="grid-panel"><div id="',ap+"tbar",'" class="grid-tbar" style="display : none;"></div><div class="grid-view"><div class="grid-header"><table  cellspacing="0" cellpadding="0" class="grid-table"><thead></thead></table></div><div class="grid-body grid-body-scroll"><table  cellspacing="0" cellpadding="0" class="grid-table"><tbody><tfoot></tfoot></tbody></table></div></div><div id="',ap+"bbar",'" class="grid-bbar" style="display : none;"></div></div>'].join("");aq=new z(ao);aq.appendTo(S);av.set("gridEl",aq);ar=C.get(".grid-header",S);aw=C.get(".grid-table",ar);at=C.get(".grid-body",S);ay=C.get(".grid-table",at);av.set("head",ar);av.set("body",at);av.set("tbody",ay.tBodies[0]);av.set("tfoot",ay.tFoot);av.set("thead",aw.tHead);av._initHeader();if(!av._isAutoFitWidth()){an=av.get("width");av._setWidth(an)}else{an=av._getColumnsWidth();av._setWidth(an+2)}if(ax){av.setHeight(ax)}av._initListeners();av._initPaggingBar();av._initEvent();av._initData()},_initEvent:function(){this._initHeaderEvent();this._initBodyEvent();this._initDataEvent();this._initPaggingBarEvent()},_initBodyEvent:function(){var an=this,S=an.get("tbody");an._addBodyEvent(S)},_initData:function(){var S=this,an=S.get("store"),ao=S.get("loadMask"),ap=S.get("gridEl");if(ao){ao=new k.LP.LoadMask(ap,{msg:"Loading..."});S.set("loadMask",ao)}if(an&&an.autoLoad){an.load()}},_initMenu:function(){var S=this,an=S.get("showMenu"),ao=S.get("columns"),ap=null;if(an){ap=new x({columns:ao});S.set("menu",ap);S._initMenuEvent()}return ap},_initMenuEvent:function(){var S=this,an=S.get("menu");if(!an){return}an.on("columnsort",function(ap){var ao=ap.column,aq=ap.direction;if(ao.sortable){S._setSortIcon(ao.id,aq);S.sort(ao,aq)}});an.on("columnhide",function(ap){var ao=ap.column;if(!S._isLastVisibleColumn(ao)){S._setColumnVisible(ao,false);S.fire("columnhide",{column:ao})}});an.on("columnshow",function(ap){var ao=ap.column;S._setColumnVisible(ao,true);S.fire("columnshow",{column:ao})});an.on("menuhide",function(aq){var ap=aq.column,ao=S._getHeadCell(ap.id);if(ao){ao.removeClass(f)}})},_initDataEvent:function(){var S=this,an=S.get("store");if(an){an.on("beforeload",function(){var ao=S.get("loadMask");if(ao){ao.show()}});an.on("load",function(){var ao=an.getResult(),ap=S.get("loadMask");S.showData(ao);if(ap){ap.hide()}});an.on("localsort",function(ao){var ap=ao.direction==="ASC"?1:-1;S._localSort(ao.field,ap)});an.on("addrecords",function(ao){var ap=ao.data;S.appendData(ap)});an.on("removerecords",function(ao){var ap=ao.data;S.removeData(ap)});an.on("exception",function(){var ao=S.get("loadMask");if(ao){ao.hide()}});an.on("updaterecord",function(ap){var ao=ap.record;S._updateRow(ao)})}},_initHeaderEvent:function(){var S=this,au=S.get("thead"),ap=S.get("checkable"),aq=S.get("menu"),at=k.all("."+p,au);function ar(av){k.one(this).parent().addClass(f)}function ao(av){var aB=S._lookupByClass(av.target,p),aD=k.one(av.target),aC=null,aw=null,ay=null,ax=null,az=null,aA=null;if(!aB){return}aA=k.one(aB);aC=aA.parent();aw=aC.attr(E);ay=S._getColumnById(aw);if(aD.hasClass(n)){av.stopPropagation();az=aD.offset();if(!aq){aq=S._initMenu()}else{if(!aq.isHide()){aq.hide()}}aq.setCurrentColumn(ay);aq.setSortable(ay.sortable);aq.show({top:az.top+24,left:az.left})}else{if(aC.hasClass(D)){ax=aA.hasClass(Q)?"DESC":"ASC";S._setSortIcon(ay.id,ax,aC,at);S.sort(ay,ax)}}}function an(av){var aw=k.one(this).parent(),ax=aw.attr(E);aw.removeClass(f);if(aq&&!aq.isHide()&&aq.isCurrentColumn(ax)){k.one(this).parent().addClass(f)}}k.one(au).on("click",ao);at.on("mouseover",ar).on("mouseleave",an);if(ap){k.one("."+h,au).on("click",function(){S._setAllRowsSelected(k.one(this).attr("checked"))})}},_initHeader:function(){var at=this,av=at.get("showMenu"),an=at.get("columns"),ap=at.get("thead"),ar=ap.insertRow(0),S=at.get("checkable"),ao=null,au=null;function aq(ax){var ay=ax.sortable?D:"",az=ay?'<span class="grid-header-sort-icon">&nbsp;</span>':"",aA=ax.hide?ae:"",aE=av?'<span class="grid-column-menu-trigger"></span>':"",aw=ax.width,aD=ax.cls,aC=['<th align="left" class="',Z," ",aA," ",d+ax.id," ",ay,'" data-column-name="',ax.id,'" data-column-field = "',ax.dataIndex,'">','<div class ="',Z,"-inner ",aD,' "><span class="',U,'">',ax.title,"</span>",az,aE,"</div>","</th>"].join(""),aB=new z(aC);aB.attr("width",aw+"px");aB.appendTo(ar)}if(S){ao=at._getCheckedCellTemplate("grid-header-checked-column",Z);new z(ao).appendTo(ar)}k.each(an,function(ax){var aw=ax.width||ab;if(!ax.id){ax.id=k.guid("col")}ax.width=aw;aq(ax)});if(!at._isAutoFitWidth()){au=new z('<th class="'+Z+' grid-header-th-empty"><div class ="'+Z+'-inner"></div></th>');au.appendTo(ar)}},_initListeners:function(){var S=this,ao=S.get("listeners"),an=null;if(ao){for(an in ao){if(ao.hasOwnProperty(an)){S.on(an,ao[an])}}}},_isLastVisibleColumn:function(ap){var an=this,ao=an.get("columns"),S=true;if(ap.hide){S=false}k.each(ao,function(aq){if(ap!==aq&&!aq.hide){S=false;return false}});return S},_updateRow:function(an){var S=this,ap=S._findRowByRecord(an),ao=S.get("columns");if(ap){k.each(ao,function(at){var av=at.dataIndex,ar=at.id,au=at.editor,aq=au?(au.editableFun&&!au.editableFun(an[av],an)?"":o):"",ay=K+ar,aw=k.one("."+ay,ap),az=aw.one("."+l),ax=null;if(aq){aw.addClass(o)}else{aw.removeClass(o)}if(az){ax=at.renderer?at.renderer(an[av],an):an[av];ax=ax===undefined?"":ax;if(az.html()!==ax){az.html(ax);if(at.showTip){az.attr("title",S._getShowTip(at,an[av],an,false))}}}})}},_setEmptyHeadCellWidth:function(ap){var S=this,ao=S.get("thead"),an=k.one("."+V,ao);if(!an){return}if(ap<=0){an.hide()}else{an.attr("width",ap+"px");an.show()}},_autoSetInnerWidth:function(){var at=this,an=at.get("thead"),ap=at.get("tbody"),au=at.get("height"),S=at._getColumnsWidth(),av=0,ar=at._isForceFit(),aq=at.getWidth(),ao=ar?N:aq<(S+2)?N:aq-(S+2);if(ao>0&&ao<N){ao=N}at._setEmptyHeadCellWidth(ao);av=S+(ao?ao+2:0);k.one(an).parent().width(av);if(au&&!H.firefox){S-=(N+2)}k.one(ap).parent().width(S)},_initPaggingBar:function(){var au=this,ao=au.get("gridId"),av=au.get("tbar"),aq=au.get("bbar"),aw=au.get("store"),at=0,an=null,ay=null,ax=null,ap=null;function S(aA,aB){var az=k.merge(aA,{renderTo:aB});if(aw&&!az.store){az.store=aw}return new k.LP.PaggingBar(az)}function ar(az,aB){var aA=k.merge(az,{renderTo:aB});return new k.LP.ButtonBar(aA)}if(av){if(av.pageSize){an=S(av,ao+"tbar");au.set("tpaggingBar",an);at=av.pageSize}if(av.buttons){ay=ar(av,ao+"tbar");au.set("tbuttonBar",ay)}}if(aq){ax=S(aq,ao+"bbar");au.set("bpaggingBar",ax);at=aq.pageSize}if(at&&aw){ap=aw.params;if(!ap.start){ap.start=0;ap.pageIndex=0}if(!ap.limit||ap.limit!==at){ap.limit=at}}},_initPaggingBarEvent:function(){var S=this,ao=S.get("tpaggingBar"),an=S.get("bpaggingBar");if(ao){ao.on("beforepagechange",function(ap){S.fire("beforepagechange",ap)})}if(an){an.on("beforepagechange",function(ap){S.fire("beforepagechange",ap)})}},_isAutoFitWidth:function(){return !this.get("width")},_isForceFit:function(){var S=this,ao=S.get("width"),an=S.get("forceFit");return ao&&an},_isRowSelected:function(S){return k.one(S).hasClass(r)},_localSort:function(at,ar){var S=this,ao=S.get("tbody"),an=S.get("store"),aq=k.makeArray(ao.rows);function ap(aw,au){var av=C.data(aw,u);return av?av[au]:""}if(an){aq.sort(function(av,au){var ax=C.data(av,u),aw=C.data(au,u);return an.compare(ax,aw)})}else{aq.sort(function(aw,av){var ax=ap(aw,at),au=ap(av,at);if(ax<au){return -ar}if(ax>au){return ar}return 0})}k.each(aq,function(av){var au=k.one(av);au.appendTo(ao)})},_rowClickEvent:function(at){var ao=this,au=ao._findRow(at),an=ao._findCell(at),ap=ao.get("checkable"),ar=null,S=null;if(au){ar=C.data(au,u);if(an){S=ao.fire("cellclick",{data:ar,row:au,cell:an,field:C.attr(an,ad),domTarget:at});if(S===false){return}}ao.fire("rowclick",{data:ar,row:au});if(ap){if(!ao._isRowSelected(au)){ao._setRowSelected(au,true)}else{ao._setRowSelected(au,false)}}else{var aq=k.one("."+r,au.parentNode);if(aq){k.all("."+r,au.parentNode).removeClass(r);ao._onRowSelectChanged(aq[0],false)}C.addClass(au,r);ao._onRowSelectChanged(au,true)}}},_rowDoubleClickEvent:function(ap){var an=this,aq=an._findRow(ap),S=an._findCell(ap),ao=null;if(aq){ao=C.data(aq,u);if(S){an.fire("celldblclick",{data:ao,row:aq,cell:S,field:C.attr(S,ad),domTarget:ap})}an.fire("rowdblclick",{data:ao,row:aq})}},_rowOverEvent:function(an){var S=this,ao=S._findRow(an);if(ao){k.one(ao).addClass(ai)}},_rowOutEvent:function(an){var S=this,ao=S._findRow(an);if(ao){k.one(ao).removeClass(ai)}},_setColumnWidth:function(ao,an){if(typeof(ao)==="string"){ao=this._getColumn(ao)}var av=this,S=ao.id,aq="."+d+S,ar=".grid-body-td-"+S,at=av.get("thead"),ap=av.get("tbody"),au=null;if(ao.width!==an){if(an){ao.width=an}else{an=ao.width}k.one(aq,at).attr("width",an+"px");au=k.all(ar,ap);au.each(function(aw){aw.attr("width",an+"px").children(".grid-body-cell-inner").width(an)})}},_setColumnVisible:function(ao,an){if(typeof(ao)==="string"){ao=this._getColumn(ao)}if(ao){var av=this,S=ao.id,au=av._isForceFit(),aq="."+d+S,ar=".grid-body-td-"+S,at=av.get("thead"),ap=av.get("tbody");if(an){ao.hide=false;k.one(aq,at).removeClass(ae);k.all(ar,ap).removeClass(ae)}else{ao.hide=true;k.one(aq,at).addClass(ae);k.all(ar,ap).addClass(ae)}if(au){av._forceFitWidth()}else{av._autoSetInnerWidth()}}},_setHeaderChecked:function(ao){var an=this,ap=an.get("thead"),S=k.one("."+h,ap);if(S){S.attr("checked",ao)}},_setSortIcon:function(ar,at,an,au){var S=this,aq=S.get("thead"),ao=null,ap=null;an=an||S._getHeadCell(ar);ao=k.one("."+p,an);au=au||k.all("."+p,aq);ap=at==="DESC"?i:Q;au.removeClass(Q).removeClass(i);ao.addClass(ap)},_setRowSelected:function(ar,ao){var an=this,aq=C.get("."+h,ar),ap=C.data(ar,u),S=C.hasClass(ar,r);if(S===ao){return}if(aq){if(C.attr(aq,"disabled")){return}aq.checked=ao}if(ao){C.addClass(ar,r);an._onRowSelectChanged(ar,ao)}else{C.removeClass(ar,r);an._setHeaderChecked(false);an._onRowSelectChanged(ar,ao)}},_onRowSelectChanged:function(ap,an){var S=this,ao=C.data(ap,u);if(an){S.fire("rowselected",{data:ao,row:ap})}else{S.fire("rowunselected",{data:ao,row:ap})}S.fire("rowselectchanged",{data:ao,row:ap,selected:an})},_setAllRowsSelected:function(ao){var an=this,S=an.get("tbody");k.each(S.rows,function(ap){an._setRowSelected(ap,ao)})},_setWidth:function(ap){var an=this,S=an.get("body"),aq=an.get("gridEl"),ao=an._isForceFit();aq.width(ap);k.one(S).width(ap-2);aq.children(".grid-view").width(ap-2);if(ao){an._forceFitWidth()}an._autoSetInnerWidth(ap)},destroy:function(){}});function x(S){x.superclass.constructor.call(this,S);this._init()}k.extend(x,k.Base);k.augment(x,{contains:function(ao){if(!ao){return false}var S=this,ap=S.get("menuEl"),an=S.get("columnMenuEl");return ap[0]===ao||an[0]===ao||ap.contains(ao)||an.contains(ao)},getCurrentColumn:function(){return this.get("currentColumn")},hide:function(){var S=this,an=S.get("menuEl");an.css({visibility:"hidden"});S.hideColumnMenu();S.fire("menuhide",{column:S.getCurrentColumn()})},hideColumnMenu:function(){var S=this,an=S.get("columnMenuEl");an.css({visibility:"hidden"})},isCurrentColumn:function(ao){var S=this,an=S.getCurrentColumn();if(!ao||!an){return false}if(k.isObject(ao)){return ao===an}return ao===an.id},isHide:function(){var S=this,an=S.get("menuEl");return an.css("visibility")!=="visible"},setCurrentColumn:function(an){var S=this;S.set("currentColumn",an)},setSortable:function(ap){var S=this,ao=S.get("ascSortItem"),an=S.get("descSortItem");if(!ap){ao.addClass(I);an.addClass(I)}else{ao.removeClass(I);an.removeClass(I)}},show:function(ap){var S=this,ao=S.get("menuEl"),an=S._getMenuWidth();S._resetColumnsVisible();if(!k.LP.isInHorizontalView(ap.left+an)){ap.left-=an}ao.css({visibility:"visible",left:ap.left,top:ap.top});S.fire("menushow",{column:S.getCurrentColumn()})},showColumnMenu:function(ap){var S=this,ao=S._getColumnMenuWidth(),an=S.get("columnMenuEl");if(!k.LP.isInHorizontalView(ap.left+ao)){ap.left-=(2*ao)-10}an.css({visibility:"visible",left:ap.left,top:ap.top})},_createMenuItem:function(aq,an){var S=this,ap=S.get("menuEl"),ao='<div class="'+c+' "><a class="menu-item-link '+an+'" href="#">'+q+'<span class="menu-item-text">'+aq+"</span></a></div>";return new z(ao).appendTo(ap)},_createColumnMenuItem:function(ar,aq){var S=this,ao=aq||S.get("columnMenuEl"),at=ar.hide?v:a,an=['<div class="',Y," ",at,'"><a class="menu-item-link" href="#">'+q+'</span><span class="menu-item-text">',ar.title,"</span></a></div>"].join(""),ap=new z(an).appendTo(ao);ap.data(M,ar);return ap},_createSeperator:function(){var S=this,ao=S.get("menuEl"),an='<div class="grid-menu-item-separator"></div>';return new z(an).appendTo(ao)},_getMenuWidth:function(){return aa},_getColumnMenuWidth:function(){return aa},_init:function(){var S=this;S._initDom();S._initEvent()},_initDom:function(){var S=this,ao='<div class="grid-menu" style = "visibility: hidden; top:-1000px;left;-1000px"></div>',an='<div class="grid-column-menu" style = "visibility: hidden; top:-1000px;left;-1000px"></div>',at=new z(ao).appendTo("body"),ap=new z(an).appendTo("body"),au=null,ar=null,aq=null;S.set("menuEl",at);S.set("columnMenuEl",ap);au=S._createMenuItem("\u5347\u5e8f","menu-sort-asc");ar=S._createMenuItem("\u964d\u5e8f","menu-sort-desc");S._createSeperator();aq=S._createMenuItem("\u8bbe\u7f6e\u5217","menu-cols-icon");new z(q).addClass("menu-item-arrow").appendTo(aq);S.set("ascSortItem",au);S.set("descSortItem",ar);S.set("columnItem",aq);S._initColumnMenu()},_initColumnMenu:function(){var S=this,ap=S.get("columns"),an=S.get("columnMenuEl"),ao=null;k.each(ap,function(aq){S._createColumnMenuItem(aq,an)});ao=an.all("."+Y);S.set("columnItems",ao)},_initEvent:function(){var av=this,ar=av.get("menuEl"),ao=av.get("columnMenuEl"),an=av.get("ascSortItem"),at=av.get("descSortItem"),S=av.get("columnItem"),au=av.get("columnItems");function ap(ax){var aw=k.one(this);if(!aw.hasClass(I)){aw.addClass(s)}}function aq(ax){var aw=k.one(this);aw.removeClass(s)}ar.all("."+c).on("click",function(aw){aw.preventDefault();aw.stopPropagation()}).on("mouseover",ap).on("mouseout",aq);an.on("click",function(){if(!an.hasClass(I)){av.fire("columnsort",{column:av.getCurrentColumn(),direction:"ASC"})}});at.on("click",function(){if(!at.hasClass(I)){av.fire("columnsort",{column:av.getCurrentColumn(),direction:"DESC"})}});S.on("mouseenter",function(){var ax=S.offset(),aw=S.width();av.showColumnMenu({top:ax.top,left:ax.left+(aw-2)})}).on("mouseleave",function(aw){var ax=k.one(aw.toElement);if(ax&&!ax.hasClass("grid-column-menu")&&!ao.contains(ax)){av.hideColumnMenu()}});au.on("click",function(ay){ay.preventDefault();ay.stopPropagation();var ax=k.one(this),aw=ax.data(M);if(ax.hasClass(a)){ax.removeClass(a);ax.addClass(v);av.fire("columnhide",{column:aw})}else{ax.addClass(a);ax.removeClass(v);av.fire("columnshow",{column:aw})}}).on("mouseover",ap).on("mouseout",aq);k.one(m).on("click",function(aw){var ax=aw.target;if(!av.isHide()&&!av.contains(ax)){av.hide()}})},_lookupByClass:function(an,S){if(C.hasClass(an,S)){return an}return C.parent(an,"."+S)},_resetColumnsVisible:function(){var S=this,an=S.get("columnItems");an.each(function(ap){var ao=ap.data(M);if(ap.hasClass(v)!==ao.hide){if(ao.hide){ap.removeClass(a);ap.addClass(v)}else{ap.addClass(a);ap.removeClass(v)}}})}});function P(S){P.superclass.constructor.call(this,S)}k.extend(P,J,{clearError:function(){var S=this;S.cancelEdit()},cancelEdit:function(){var S=this,an=S.get("columns");k.each(an,function(ap){var ao=ap.editor;if(ao&&!ao.isHide()){ao.hide()}})},hasError:function(){var an=this,S=false,ao=an.get("showError"),aq=null,ap=null;if(ao){ap=an.get("tbody");S=!!k.one(ap).one("."+y)}if(!S){aq=an.get("columns");k.each(aq,function(at){var ar=at.editor;if(ar&&!ar.isHide()&&ar.hasError()){S=true;return false}})}return S},setCellToEdit:function(ao,ar){var an=this,aq=an._getColumn(ar),S=null,ap=null;if(aq){S=an._getCell(ao,aq.id);ap=an._getEditor(ar)}if(C.hasClass(S,o)){an._showEditor(ap,S,ao[ar],ao)}},_attachEditEvent:function(ao){var S=this,an=ao.editor;an.on("change",S._getChangeEvent(ao));an.on("hide",function(ap){S.set("editRecord",null);S.set("editor",null)});an.on("next",S._getNextEvent(ao))},_getNextEvent:function(an){var S=this;return function(ar){var ao=ar.record,at=an.dataIndex,au=S._getNextEditCellInfo(ao,at),aq=au.cell,at=au.field,ao=au.record,ap=null;if(aq&&C.hasClass(aq,o)){ap=S._getEditor(at);S._showEditor(ap,aq,ao[at],ao)}}},_getNextEditCellInfo:function(ao,ap){var an=this,S=null,ar=ap,aq=null;while(ao&&(!S||!an._isEditableCell(S))){aq=an._getNextEditColumn(ar);if(aq){S=an._getCell(ao,aq.id);ar=aq.dataIndex}else{ao=an._getNextRecord(ao);ar=null}}return{cell:S,field:ar,record:ao}},_getNextEditColumn:function(at){var an=this,aq=an.get("columns"),ao=-1,ar=aq.length,S=null;if(at){for(var ap=0;ap<ar;ap++){if(aq[ap].dataIndex===at){ao=ap;break}}}for(var ap=ao+1;ap<ar;ap++){if(aq[ap].editor){S=aq[ap];break}}return S},_getNextRecord:function(an){var S=this,ao=S.get("store");return ao.findNextRecord(an)},_getChangeEvent:function(an){var S=this;return function(aq){var ar=aq.value,ao=aq.record,at=an.dataIndex,ap=S.get("store");if(ao[at]!==ar){ap.setValue(ao,at,ar)}}},_addError:function(S,ap){var ao=S.one("."+t),aq=S.one("."+A),an=['<span class="',A,'" title="',ap,'"></span>'].join("");if(!aq){ao.addClass(y);aq=new z(an).appendTo(ao)}else{aq.attr("title",ap)}},_clearError:function(S){var an=S.one("."+t),ao=S.one("."+A);an.removeClass(y);if(ao){ao.remove()}},_clearDirtyIcons:function(){var S=this,an=S.get("tbody");k.all("."+b,an).removeClass(b)},_getEditor:function(ap){var S=this,an=S.get("columns"),ao=null;k.each(an,function(aq){if(aq.dataIndex===ap){ao=aq.editor;return false}});return ao},_getCellTemplate:function(an,aq,aC,aA,at){var ay=this,az=aq.dataIndex,ao=aq.width,ax=ay._getShowTip(aq,aA,at,true),au=aq.hide?ae:"",aw=aq.editor,S=aw?(aw.editableFun&&!aw.editableFun(aA,at)?"":o):"",ar=ay.get("showError"),aD=ar?(aw&&aw.validator?aw.validator(aA,at):""):"",av=aD?'<span class="'+A+'" title="'+aD+'"></span>':"",ap=aD?y:"",aB=['<td  class="grid-body-cell grid-body-td-',aq.id," ",au," ",S,'" data-column-name="',aq.id,'" colindex="',an,'" data-column-field = "',az,'" width="',ao,'px">','<div class="',t," ",ap,'" style="width : ',ao,'px"><span class="',l,' " ',ax,">",aC,"</span>",av,"</div></td>"].join("");return aB},_getTextEditorTemplate:function(an){an=an||80;var S=['<div class="lp-text-editor grid-editor" style="position : absolute; z-index : 1000; visibility : hidden; left : -10000px; top : -10000px; overflow : auto;">','<input type="text" name=""autocomplete="off" size="20" class="lp-form-text-field lp-editor-field" style="width : ',an,'px; height : 20px;">'].join("");return S},_getRowDataByCell:function(an){var S=this,ap=S._findRow(an),ao=C.data(ap,u);return ao},_getCellValue:function(an,aq){var S=this,ar=S._findRow(an),ap=C.data(ar,u),ao=ap?ap[aq]:null;return ao},_hasEditor:function(S){return this.hasAttr(al+S)},_hideEditor:function(S){S.css({visibility:"hidden",left:-10000,top:-10000})},_isEditableCell:function(S){return C.hasClass(S,o)},_init:function(){P.superclass._init.call(this);var S=this,an=S.get("columns");k.each(an,function(ap){var ao=ap.editor,aq=null;if(!ao||ao.isEditor){return}aq=ah.types[ao.type||"text"];ap.editor=new aq(ao);S._attachEditEvent(ap)})},_initEvent:function(){var S=this;k.Event.on(m,"click",function(aq){var ap=S.get("editor"),ao=aq.target,an=S._findCell(aq.target);if(!an&&ap&&!ap.isHide()&&!ap.hasError()&&!ap.isContains(ao)){ap.hide()}});S.constructor.superclass._initEvent.call(S)},_initDataEvent:function(){var S=this,an=S.get("store");an.on("updaterecord",function(ap){var ao=ap.record;S._setRowValue(ao,ap.field)});S.on("rowremoved",function(aq){var ao=S.get("editRecord"),ap=S.get("editor");if(ao&&ap){if(ao===aq.data&&!ap.isHide()){ap.hide()}}});an.on("acceptchanges",function(ao){S._clearDirtyIcons()});S.constructor.superclass._initDataEvent.call(this)},_rowClickEvent:function(au){var ao=this,an=ao._findCell(au),at=null,aq=null,ar=null,S=null,ap=null;if(an){at=C.attr(an,ad);aq=ao._getEditor(at);ar=ao.get("editor");if(ar&&ar!==aq){if(!ar.isHide()&&!ar.hasError()){ar.hide()}}if(at&&aq){if(!aq.isHide()&&aq.hasError()){aq._focus();return}ap=ao._getRowDataByCell(an);if(ap){if(!ao._isEditableCell(an)){return}S=ao.fire("beforeedit",{cell:an,field:at,data:ap,editor:aq});if(S!==false){ao._showEditor(aq,an,ap[at],ap)}}return}}ao.constructor.superclass._rowClickEvent.call(this,au)},_setRowValue:function(ap,ao){var S=this,aq=S._findRowByRecord(ap),an=S.get("columns");if(aq){k.each(an,function(at){var aw=at.dataIndex,ar=at.id,az=K+ar,ax=k.one("."+az,aq),aB=ax.one("."+l),av=at.editor,aA=av&&av.validator?av.validator(ap[aw],ap):"",ay=null,au=S.get("showError");if(ao===aw){ax.addClass(b)}if(aB){ay=at.renderer?at.renderer(ap[aw],ap):ap[aw];ay=ay===undefined?"":ay;aB.html(ay);if(at.showTip){aB.attr("title",S._getShowTip(at,ap[aw],ap,false))}if(!au){return}if(aA){S._addError(ax,aA)}else{S._clearError(ax)}}})}},_showEditor:function(aq,au,at,ap){var ar=this,ao=C.offset(au),S=C.width(au),aw=C.get("."+t,au),av=C.height(aw),an=ar.get("editor");if(an&&!an.isHide()&&!an.hasError()){an.hide()}ar.set("editRecord",ap);ar.set("editor",aq);if(H.ie===7){aq.setWidth(S-4)}else{aq.setWidth(S-2)}aq.setValue(at,ap);aq.show({container:aw,left:0,top:2})}});function ah(an){var S=this;an=k.merge({isEditor:true},an);k.mix(S,an);ah.superclass.constructor.call(S,an);S._init();S.events=["beforechange","change"]}k.extend(ah,k.Base);k.augment(ah,{CHANGE_EVENT:"blur",INIT_VALUE:"",set:function(S,an){ah.superclass.set.call(this,S,an,{silent:1})},hasError:function(){var S=this,an=S.get("el");return an.hasClass(ac)},hide:function(){var S=this,an=S.get("el");S._clearError();an.css({visibility:"hidden",left:-10000,top:-10000});S.fire("hide",{record:S.get("record"),editor:S});S._setValue(S.INIT_VALUE);k.one("body").append(an)},getValue:function(){var S=this,an=S.get("editEl");return an?S._getValue():S.INIT_VALUE},isHide:function(){var S=this,an=S.get("el");return an.css("visibility")==="hidden"},isContains:function(an){var S=this,ao=S.get("el");return ao.contains(an)},setValue:function(ap,an){var S=this,ao=S.get("editEl");S.set("record",an);if(ao){S._setValue(ap);S._validate(ap,an)}},show:function(ap){var S=this,ao=S.get("el"),an=ap.container;if(an){k.one(an).append(ao)}ao.css({visibility:"visible",left:ap.left,top:ap.top});S._focus();S.fire("show",{record:S.get("record"),editor:S})},setWidth:function(ao){var S=this,an=S.get("editEl");an.width(ao)},setHeight:function(an){var S=this,ao=S.get("editEl");ao.height(an)},_basicValidator:function(an,ao){var S=this;if(S.required&&(an===undefined||an===null||k.trim(an.toString())==="")){return"\u4e0d\u80fd\u4e3a\u7a7a"}return""},_basicFormat:function(S){if(S===undefined||k.trim(S.toString())===""){return undefined}return S},_clearError:function(){var S=this,an=S.get("el"),ao=an.one("."+w);an.removeClass(ac);ao.attr("title","")},_focus:function(){var S=this,an=S.get("editEl");an[0].focus()},_getTemplate:function(){var S=['<input type="text" name=""autocomplete="off" size="20" class="lp-form-text-field lp-editor-field"  style="height : 20px;">','<s class="',w,'"></s>'].join("");return S},_getEditElemnt:function(){var S=this,an=S.get("el");return k.one(an[0].firstChild)},_getValue:function(an){var S=this;an=an||S.get("editEl");return an.val()},_init:function(){var S=this;S._initDom();S._initPreventEvent();S._initEvent();S._initKeyEvent()},_initDom:function(){var S=this,aq=null,ap=null,ao=['<div class="grid-editor" style="position : absolute; z-index : 1000; visibility : hidden; left : -10000px; top : -10000px; overflow : auto;">',S._getTemplate(),"</div>"].join(""),an=S.get("container")||C.get("body");aq=new z(ao).appendTo(an);S.set("container",an);S.set("el",aq);ap=S._getEditElemnt();S.set("editEl",ap)},_initEvent:function(){var S=this,ao=S.get("el"),an=S.get("editEl");ao.on("click",function(ap){ap.stopPropagation()});an.on(S.CHANGE_EVENT,function(ar){if(!S.isHide()){var ap=k.one(this),aq=S._valueChange(ap);if(!aq){ar.preventDefault()}}})},_initPreventEvent:function(){var S=this,an=S.get("el");an.on("click",function(ao){ao.stopPropagation()})},_initKeyEvent:function(){var S=this,an=S.get("editEl");an.on("keydown",function(ao){var ap=ao.keyCode;switch(ap){case G:S._keyEnterEvent(an);break;case e:S._keyCancelEditEvent();break;case R:ao.halt();S._keyTabEvent(an);break;default:break}})},_keyEnterEvent:function(S){this._completeEdit(S)},_keyCancelEditEvent:function(){var S=this;S.hide()},_keyTabEvent:function(an){var S=this,ao=S._completeEdit(an);if(ao){S.fire("next",{record:S.get("record")})}},_completeEdit:function(an){var S=this,ao=S._valueChange(an);if(ao){S.hide()}return ao},_valueChange:function(ao,aq){var S=this,an=S.get("record"),ap=null;aq=aq||S._getValue(ao);ap=S._validate(aq,an);aq=S._basicFormat(aq);aq=S.format?S.format(aq):aq;if(ap){S.fire("change",{value:aq,record:an});return true}return false},_setError:function(ao){var S=this,an=S.get("el"),ap=an.one("."+w);an.addClass(ac);ap.attr("title",ao)},_setValue:function(ao,an){var S=this;an=an||S.get("editEl");an.val(ao)},_validate:function(ap,aq){var an=this,S=null,ao=true;S=an._basicValidator(ap)||(an.validator&&an.validator(ap,aq));ao=S?false:true;if(ao){an._clearError()}else{an._setError(S)}return ao},destroy:function(){var S=this,an=S.get("el");an.remove();S.detach();S.__attrVals={}}});function ak(S){ak.superclass.constructor.call(this,S)}k.extend(ak,ah);k.augment(ak,{_basicFormat:function(S){if(S){S=S.replace(/</g,"&lt;").replace(/>/,"&gt;").replace(/\"/,"&quot;")}return S},_setValue:function(an,S){if(an){an=an.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}this.constructor.superclass._setValue.call(this,an,S)}});function ag(S){ag.superclass.constructor.call(this,S)}k.extend(ag,ah);k.augment(ag,{_basicFormat:function(S){if(S===undefined||k.trim(S.toString())===""){return undefined}return parseFloat(S)},_basicValidator:function(S){var an=this.constructor.superclass._basicValidator.call(this,S);if(!an&&S&&isNaN(S)){an="\u8bf7\u8f93\u5165\u6570\u5b57"}return an}});function B(S){B.superclass.constructor.call(this,S)}k.extend(B,ah);k.augment(B,{CHANGE_EVENT:"change",INIT_VALUE:false,setHeight:function(S){return},_getTemplate:function(){var S=['<input type="checkbox" name="" class="lp-form-checkbox-field lp-editor-field"  style="height : 20px;">','<s class="',w,'"></s>'].join("");return S},_getValue:function(S){S=S||this.get("editEl");var an=S.attr("checked");return an?true:false},_setValue:function(ao,an){var S=this;an=an||S.get("editEl");an.attr("checked",ao)}});function j(S){j.superclass.constructor.call(this,S)}k.extend(j,ah);k.augment(j,{_getTemplate:function(){var S=['<select class="lp-form-select-field lp-editor-field" tabindex="1" id="sel',k.guid(),'"  style="height : 20px;"></select>','<s class="',w,'"></s>'].join("");return S},_initDom:function(){this.constructor.superclass._initDom.call(this);var S=this,ao=S.get("editEl"),an=S.items,ap=null;if(!S.required){S._createItem("\u8bf7\u9009\u62e9",S.INIT_VALUE,ao)}if(k.isArray(an)){k.each(an,function(aq){S._createItem(aq.name,aq.value,ao)})}else{for(ap in an){if(an.hasOwnProperty(ap)){S._createItem(an[ap],ap,ao)}}}},_createItem:function(ao,ap,S){var an='<option value="'+ap+'">'+ao+"</option>";new z(an).appendTo(S)}});function X(S){X.superclass.constructor.call(this,S)}k.extend(X,ah);k.augment(X,{_basicValidator:function(an){var S=this;validText=this.constructor.superclass._basicValidator.call(this,an);if(!validText&&an&&!S._isDate(an)){validText="\u4e0d\u662f\u6709\u6548\u7684\u65e5\u671f\u683c\u5f0f\uff01"}return validText},_isDate:function(S){if(k.isNumber(S)){return true}if(k.isString(S)){S=Date.parse(S.replace(/-/g,"/"))}return k.isNumber(S)&&!isNaN(S)},_validate:function(ap,aq){var an=this,S=null,ao=true;S=an._basicValidator(ap)||(an.validator&&an.validator(an._basicFormat(ap),aq));ao=S?false:true;if(ao){an._clearError()}else{an._setError(S)}return ao},isContains:function(an){var S=this;return S.constructor.superclass.isContains.call(this,an)||k.one(an).parent(".ks-cal-box")},hide:function(){var S=this,an=S.get("datepicker");an.hide();S.constructor.superclass.hide.call(this)},setHeight:function(){return},setWidth:function(S){this.constructor.superclass.setWidth.call(this,S-15)},_basicFormat:function(S){if(k.isString(S)){S=S.replace(/-/g,"/")}return new Date(S).getTime()},_getTemplate:function(){var S=['<input type="text" name=""autocomplete="off" size="20" class="lp-form-text-field lp-editor-field"  style="height : 20px;">','<s class="',w,'"></s>'].join("");return S},_init:function(){var S=this;if(S.showTime){}k.use("lpassert/calendar",function(an,ao){S.set("Calendar",ao);S.constructor.superclass._init.call(S)})},_initDom:function(){this.constructor.superclass._initDom.call(this);var S=this,an=S.get("editEl"),ap=S.get("Calendar"),aq="grid-date"+k.guid(),ao=null;an.attr("id",aq);ao=new ap([{selector:"#"+aq,showTime:S.showTime,allowEdit:true}]);S.set("datepicker",ao["#"+aq])},_setValue:function(aq,ap){var S=this,an=S.showTime?k.LP.Format.datetimeRenderer(aq):k.LP.Format.dateRenderer(aq),ao=S.get("datepicker");ap=ap||S.get("editEl");ap.val(an);if(aq&&aq!==S.INIT_VALUE){ao.render({selected:new Date(aq),date:new Date(aq)})}}});function af(S){af.superclass.constructor.call(this,S)}k.extend(af,ah);k.augment(af,{hide:function(){var S=this;if(S._isSelectShow()){S._hideSelect()}S.constructor.superclass.hide.call(this)},isContains:function(an){var S=this;return S.constructor.superclass.isContains.call(this,an)||k.one(an).parent(".lp-multiple-wrap")},setValue:function(ao,an){var S=this;ao=ao||[];S.constructor.superclass.setValue.call(this,ao,an)},setWidth:function(S){this.constructor.superclass.setWidth.call(this,S-17)},setHeight:function(){return},_createItem:function(ap,ao,S){var an='<li class="multiple-item"> <input class="multiple-item-checkbox"  type="checkbox" name="'+ao+'" />'+ap+"</li>";new z(an).appendTo(S)},_getSelectOffset:function(){var S=this,an=S.get("editEl"),ao=an.offset();ao.top+=an.height()+2;return ao},_getText:function(aq){var S=this,an=S.get("record"),ao=S.get("items"),ap=S.get("renderer");aq=aq||S._getValue();if(!ap){ap=k.LP.Format.multipleItemsRenderer(ao);S.set("renderer",ap)}return ap(aq,an)},_getValue:function(){var S=this,ao=[],ap=S.get("listEl"),an=ap.all(".multiple-item-checkbox");k.each(an,function(aq){if(aq.checked){ao.push(aq.name)}});return ao},_getTemplate:function(){var S=['<input type="text" readonly = "true" name=""autocomplete="off" size="20" class="lp-form-multiple-field lp-editor-field"  style="height : 20px;">','<s class="',w,'"></s>'].join("");return S},_hideSelect:function(){var S=this,an=S.get("selectEl");an.css({visibility:"hidden",left:-10000,top:-10000})},_isSelectShow:function(){var S=this,an=S.get("selectEl");return an.css("visibility")!=="hidden"&&an.width()!==0},_initDom:function(at){this.constructor.superclass._initDom.call(this);var S=this,ao=S.get("items"),an='<div class="lp-multiple-wrap"  style="position : absolute; z-index : 1200; visibility : hidden; left : -10000px; top : -10000px; overflow : auto;"><ul class="multiple-list ks-clear"></ul><div class="multiple-footer" style="text-align:center"><span class="x-btn x-btn-default-small"><button autocomplete="off" hidefocus="true" type="button" style="width:74px;"><span class="x-btn-inner">\u786e\u8ba4</span></button></span></div></div>',ap=new z(an).appendTo("body"),ar=ap.one(".multiple-list"),aq=ap.one("button"),au=null;S.set("selectEl",ap);S.set("listEl",ar);S.set("btnEl",aq);S.createItems()},createItems:function(){var S=this,an=S.get("items"),ao=S.get("listEl");ao.children().remove();if(k.isArray(an)){k.each(an,function(ap){S._createItem(ap.name,ap.value,ao)})}else{for(id in an){if(an.hasOwnProperty(id)){S._createItem(an[id],id,ao)}}}},_initEvent:function(){var S=this,ap=S.get("listEl"),an=S.get("editEl"),ao=S.get("btnEl");an.on("click",function(aq){aq.stopPropagation();S._toggleSelect()});ap.on("click",function(aq){aq.stopPropagation()});ao.on("click",function(aq){aq.stopPropagation();var ar=S.getValue();S._setText(S._getText(ar));S._hideSelect();S._valueChange(an,ar)})},_setText:function(ao){var S=this,an=S.get("editEl");an.val(ao)},_setSelectValue:function(ao){var S=this,ap=S.get("listEl"),an=ap.all(".multiple-item-checkbox"),aq=null;an.attr("checked",false);aq=k.filter(an,function(ar){return k.inArray(ar.name,ao)});k.all(aq).attr("checked","checked")},_setValue:function(an){var S=this,ao=S._getText(an);S._setText(ao);S._setSelectValue(an)},_showSelect:function(an){var S=this,ao=S.get("selectEl");an=an||S._getSelectOffset();ao.css({visibility:"visible",left:an.left,top:an.top})},_toggleSelect:function(){var S=this;if(S._isSelectShow()){S._hideSelect()}else{S._showSelect()}}});ah.types={text:ak,number:ag,check:B,select:j,date:X,multipleSelect:af};k.namespace("LP");k.LP.Grid=J;k.LP.EditGrid=P},{requires:["core","./uicommon","./bar","./css/grid.css"]});
