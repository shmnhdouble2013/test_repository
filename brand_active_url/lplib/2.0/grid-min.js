KISSY.add(function(n){var F=n.DOM,K=n.UA,C=n.Node,X=n.Event,ae=window,p=document,H="data-column-name",aj="data-column-field",af="grid-header-th",aa="grid-header-th-empty",s="grid-header-th-inner",Z="grid-header-inner-title",o="grid-body-cell-text",k="grid-checkbox",P="grid-row",u="grid-row-selected",ao="grid-row-over",Y="grid-body-cell",w="grid-body-cell-inner",L="grid-height",d="grid-width",j="hover",ak="ks-hidden",g="grid-allow-scroll",G="sortable",V="sorted-asc",l="sorted-desc",ap="grid-row-odd",I="grid-row-even",q="grid-column-menu-trigger",e="grid-header-column-",x="row-element",ah=80,T=25,i=25,at=30,ab=80,R=15,Q="data-column",v="ks-active",c="grid-menu-item",ad="grid-column-menu-item",a="menu-item-checked",y="menu-item-unchecked",M="lp-item-disabled",t='<span class="menu-item-icon"/>',ag=148,ar="col",r="grid-editable-cell",b="grid-dirty-cell",B="grid-error-cell",D="grid-cell-error-icon",f="grid-cell-edit-icon",O="grid-body-td-",ai="grid-error-editor",z="grid-error-editor-icon",J=13,h=27,W=9;function N(au){var S=this;au=au||{};if(!au.renderTo&&!au.container){throw"please assign the id of rendered Dom,of the container of this grid!"}au=n.merge(N.config,au);N.superclass.constructor.call(S,au);S.events=["beginappend","afterappend","beginshow","aftershow","rowremoved","rowcreated","beforepagechange","rowclick","cellclick","rowdblclick","celldblclick","rowselected","rowunselected","rowselectchanged"];S._init()}N.config={showMenu:false};n.extend(N,n.Base);n.augment(N,{set:function(S,au){N.superclass.set.call(this,S,au,{silent:1})},appendData:function(aw){var S=this,av=[],au=S._getRowCount();S.fire("beginappend",{data:aw});n.each(aw,function(ay,ax){var az=S._createRow(ay,au+ax);av.push(az)});S.fire("afterappend",{rows:av,data:aw})},addSummary:function(au){var S=this,av=S.get("tfoot");n.all(av.rows).remove();this._createSummaryRow(au)},clearData:function(){var au=this,S=au.get("tbody"),av=S.rows;au._setHeaderChecked(false);n.each(av,function(aw){au.fire("rowremoved",{data:F.data(aw,x),row:aw})});n.all(av).remove()},clearSelection:function(){this._setAllRowsSelected(false)},filter:function(ay,ax){var au=this,S=au.get("tbody"),aw=n.makeArray(S.rows),av=typeof ax==="function"?ax:function(az){return az===ax};n.each(aw,function(aB){var az=n.one(aB),aA=F.data(aB,x);if(ax===null){az.show()}else{if(!aA||!av(aA[ay])){az.hide()}else{az.show()}}})},getWidth:function(){var S=this;return S.get("width")||S.get("gridEl").width()},getSelection:function(){var S=this,au=S.get("tbody"),av=n.all("."+u,au),aw=[];n.each(av,function(ay){var ax=F.data(ay,x);if(ax){aw.push(ax)}});return aw},getSelected:function(){var S=this,au=S.get("tbody"),av=n.one("."+u,au);return av?F.data(av,x):null},hideColumn:function(S){this._setColumnVisible(S,false)},setAllSelection:function(){this._setAllRowsSelected(true)},setSelection:function(ax,au){var S=this,av=S.get("tbody"),aw=av.rows;n.each(aw,function(az){var ay=F.data(az,x);if(ay&&n.inArray(ay[ax],au)){S._setRowSelected(az,true)}})},setHeight:function(av){var au=this,ax=au.get("gridEl"),ay=T,S=au.get("body"),aw=n.one(S);ax.height(av);if(au.get("tbar")){ay+=(i+2);if(au.get("tbar").buttons){ay+=4}}if(au.get("bbar")){ay+=(i+2)}if(av-ay>0){aw.height(av-ay);aw.css("overflow-y","scroll")}ax.addClass(L)},setWidth:function(au){var S=this;S.set("width",au);S._setWidth(au)},showColumn:function(S){this._setColumnVisible(S,true)},sort:function(av,ax){var S=this,aw,au=S.get("store"),ay=n.isString(ax)?ax:(ax===1?"ASC":"DESC");if(typeof av==="string"){aw=av}else{aw=av.dataIndex}if(au){au.sort(aw,ay)}else{S._localSort(aw,ax)}},showData:function(au){var S=this;S.fire("beginshow");S.clearData();n.each(au,function(aw,av){S._createRow(aw,av)});S._afterShow();S.fire("aftershow")},removeData:function(aw){var S=this,au=S.get("tbody"),av=n.makeArray(au.rows);n.each(av,function(ay){var ax=F.data(ay,x);if(ax&&n.inArray(ax,aw)){S.fire("rowremoved",{data:ax,row:ay});F.remove(ay)}})},_addBodyEvent:function(aw){var au=this,ax=au.get("head"),S=au.get("body"),av=n.one(S);n.one(aw).on("click",function(ay){au._rowClickEvent(ay.target)}).on("mouseover",function(ay){au._rowOverEvent(ay.target)}).on("mouseout",function(ay){au._rowOutEvent(ay.target)}).on("dblclick",function(ay){au._rowDoubleClickEvent(ay.target)});av.on("scroll",function(ay){var az=av.scrollLeft();if(au.get("allowScroll")){n.one(ax).one(".grid-table").css({left:az*-1})}else{n.one(ax).scrollLeft(az)}})},_afterShow:function(){var aw=this,az=aw.get("tbody"),av=aw.get("body"),ay=n.one(av),au,S,aA,ax;if(K.ie===6||K.ie===7){au=aw.get("height");if(!au){S=ay.width();ax=av.scrollWidth;if(ax>S){aA=n.one(az).height();ay.height(aA+17)}else{ay.css("height","auto")}}}},_createRow:function(ax,aw){var au=this,S=au.get("tbody"),aA=au._getRowTemplate(aw,ax),av=new C(aA).appendTo(S),az=av.getDOMNode(),ay=az.lastChild;F.data(az,x,ax);F.addClass(ay,"lp-last");au.fire("rowcreated",{data:ax,row:az});return av},_createSummaryRow:function(av){var S=this,aw=S.get("tfoot"),ax=S._getSummaryTemplate(av),au=new C(ax).appendTo(aw);return au},_lookupByClass:function(au,S){if(F.hasClass(au,S)){return au}return F.parent(au,"."+S)},_findRowByRecord:function(av){var au=this,aw=au.get("tbody"),ax=aw.rows,S=null;n.each(ax,function(az){var ay=F.data(az,x);if(ay===av){S=az;return false}});return S},_findRow:function(S){return this._lookupByClass(S,P)},_findCell:function(S){return this._lookupByClass(S,Y)},_getCell:function(aw,ax){var au=this,ay=au._findRowByRecord(aw),av=O+ax,S=n.one("."+av,ay);return S},_forceFitColumns:function(ax){var aC=this,aA=aC.getWidth(),aB=aC.get("height"),aF=0,av=0,aE=aC.get("checkable")?at+1:0,au=0,S=1,aD=0,az=0,ay=null,aw=0;ax=ax||aC.get("columns");az=ax.length;n.each(ax,function(aH){aH.width=aH.width||ab;var aG=aH.originWidth||aH.width;if(!aH.hide){aF+=aG;av+=1}});au=av*1+2+aE+(aB?R+2:0);S=(aA-au)/aF;aD=0;if(S!==1){n.each(ax,function(aG){if(!aG.hide){aG.originWidth=aG.originWidth||aG.width;aG.width=Math.floor(aG.originWidth*S);aD+=aG.width;ay=aG}});aw=aA-(aD+au);if(az&&ay){ay.width+=aw}}},_forceFitWidth:function(){var S=this,au=S.get("columns");S._forceFitColumns();n.each(au,function(av){if(!av.hide){S._setColumnWidth(av)}})},_getRowCount:function(){var S=this,au=S.get("tbody");return n.all("."+P,au).length},_getCheckedCellTemplate:function(au,S){return['<td width="30px" align="center" class="',au," ",S,'"><div class="',S,'-inner"><span class="gwt-CheckBox"><input type="checkbox" class="',k,'" tabindex="0"></span></div></td>'].join("")},_getColumn:function(aw){var au=this,av=au.get("columns"),S=null;n.each(av,function(ax){if(ax.dataIndex===aw){S=ax;return false}});return S},_getColumnById:function(aw){var au=this,av=au.get("columns"),S=null;n.each(av,function(ax){if(ax.id===aw){S=ax;return false}});return S},_getHeadCell:function(ax){var au=this,aw=au.get("thead"),av="."+e+ax,S=n.one(av,aw);return S},_getRowTemplate:function(ay,aw){var az=this,aB=az.get("columns"),av=ay%2===0?ap:I,ax=[],aA=null,aC=null,S="",au=az.get("checkable");if(au){aC=az._getCheckedCellTemplate("grid-row-checked-column",Y);ax.push(aC)}n.each(aB,function(aE,aG){var aF=az._getFieldValue(aw,aE.dataIndex),aH=az._getRenderText(aE,aF,aw),aD=az._getCellTemplate(aG,aE,aH,aF,aw);ax.push(aD)});aA=['<tr rowIndex="',ay,'" class="',P," ",av,'">',ax.join(""),S,"</tr>"].join("");return aA},_getRenderText:function(au,av,aw){var ax=av;if(au.renderer){try{ax=au.renderer(av,aw)}catch(S){n.error("renderer error,occurred in column: "+au.title)}}return ax},_getFieldValue:function(ax,aw){if(!aw){return""}var au=aw.split("."),av=ax,S;n.each(au,function(ay){if(av){S=av[ay];av=S}else{return false}});return S},_getSummaryTemplate:function(ay){var az=this,aB=az.get("columns"),ax=[],aw=-1,av=-1,aA=null,au=az.get("checkable");if(au){av+=1}function S(aC){if(aC>0){return'<td class="'+Y+'" colspan="'+aC+'"></td>'}return""}n.each(aB,function(aD,aF){if(!aD.hide){av+=1;if(aD.summary){ax.push(S(av-aw-1));var aE=az._getFieldValue(ay,aD.dataIndex),aG="\u603b\u8ba1\uff1a"+az._getRenderText(aD,aE,ay),aC=az._getCellTemplate(aF,aD,aG,ay);ax.push(aC);aw=av}}});if(aw!==av){ax.push(S(av-aw))}aA=['<tr class="',P,'">',ax.join(""),"</tr>"].join("");return aA},_getCellTemplate:function(S,av,aD,aB,aw){var az=this,aA=av.dataIndex,au=av.width,ay=az._getShowTip(av,aB,aw,true),ax=av.hide?ak:"",aC=['<td  class="grid-body-cell grid-body-td-',av.id," ",ax,'" data-column-name="',av.id,'" colindex="',S,'" data-column-field = "',aA,'" width="',au,'px">','<div class="',w,'" style="width : ',au,'px"><span class="',o,' " ',ay,">",aD,"</span></div></td>"].join("");return aC},_getShowTip:function(au,ax,ay,S){var av=au.showTip,az=ax,aw="";if(!av){return""}if(n.isFunction(av)){az=av(ax,ay)}if(!!S){aw='title="'+(az||"")+'"'}else{aw=az||""}return aw},_getColumnsWidth:function(){var au=this,aw=au.get("columns"),av=au.get("checkable"),S=0;if(av){S+=31}n.each(aw,function(ax){if(!ax.hide){S+=ax.width+1}});return S},_init:function(){var aB=this,aw=aB.get("gridId"),S=aB.get("container"),aA=aB.get("renderTo"),av=null,ax=null,ay=null,aC=null,az=null,aE=null,au=0,aD=aB.get("height");if(!S){S=F.get("#"+aA);aB.set("container",S)}if(!aw){aw=aA+"grid";aB.set("gridId",aw)}av=['<div id="',aw,'" class="grid-panel"><div id="',aw+"tbar",'" class="grid-tbar" style="display : none;"></div><div class="grid-view"><div class="grid-header"><table  cellspacing="0" cellpadding="0" class="grid-table"><thead></thead></table></div><div class="grid-body grid-body-scroll"><table  cellspacing="0" cellpadding="0" class="grid-table"><tbody><tfoot></tfoot></tbody></table></div></div><div id="',aw+"bbar",'" class="grid-bbar" style="display : none;"></div></div>'].join("");ax=new C(av);ax.appendTo(S);aB.set("gridEl",ax);ay=F.get(".grid-header",S);aC=F.get(".grid-table",ay);az=F.get(".grid-body",S);aE=F.get(".grid-table",az);aB.set("head",ay);aB.set("headerTable",aC);aB.set("body",az);aB.set("tbody",aE.tBodies[0]);aB.set("tfoot",aE.tFoot);aB.set("thead",aC.tHead);aB._initHeader();if(!aB._isAutoFitWidth()){au=aB.get("width");aB._setWidth(au)}else{au=aB._getColumnsWidth();aB._setWidth(au+2)}if(aB.get("allowScroll")){ax.addClass(g)}if(aD){aB.setHeight(aD)}aB._initListeners();aB._initPaggingBar();aB._initEvent();aB._initData()},_initEvent:function(){this._initHeaderEvent();this._initBodyEvent();this._initDataEvent();this._initPaggingBarEvent();if(this.get("allowScroll")){this._initScrollEvnet()}},_initScrollEvnet:function(){var S=this,av=S.get("head"),au=S.get("headerTable");X.on(ae,"scroll",function(){var ay=F.offset(au),aw=F.offset(av),ax=F.scrollTop();if(ax<=aw.top){F.css(au,{top:0})}else{if(!n.LP.isInVerticalView(ay.top)){F.css(au,{top:ax-aw.top})}else{if(ay.top>ax&&ax>aw.top){F.css(au,{top:ax-aw.top})}}}})},_initBodyEvent:function(){var au=this,S=au.get("tbody");au._addBodyEvent(S)},_initData:function(){var S=this,au=S.get("store"),av=S.get("loadMask"),aw=S.get("gridEl");if(av){av=new n.LP.LoadMask(aw,{msg:"Loading..."});S.set("loadMask",av)}if(au&&au.autoLoad){au.load()}},_initMenu:function(){var S=this,au=S.get("showMenu"),av=S.get("columns"),aw=null;if(au){aw=new A({columns:av});S.set("menu",aw);S._initMenuEvent()}return aw},_initMenuEvent:function(){var S=this,au=S.get("menu");if(!au){return}au.on("columnsort",function(aw){var av=aw.column,ax=aw.direction;if(av.sortable){S._setSortIcon(av.id,ax);S.sort(av,ax)}});au.on("columnhide",function(aw){var av=aw.column;if(!S._isLastVisibleColumn(av)){S._setColumnVisible(av,false);S.fire("columnhide",{column:av})}});au.on("columnshow",function(aw){var av=aw.column;S._setColumnVisible(av,true);S.fire("columnshow",{column:av})});au.on("menuhide",function(ax){var aw=ax.column,av=S._getHeadCell(aw.id);if(av){av.removeClass(j)}})},_initDataEvent:function(){var S=this,au=S.get("store");if(au){au.on("beforeload",function(){var av=S.get("loadMask");if(av){av.show()}});au.on("load",function(){var av=au.getResult(),aw=S.get("loadMask");S.showData(av);if(aw){aw.hide()}});au.on("localsort",function(av){var aw=av.direction==="ASC"?1:-1;S._localSort(av.field,aw)});au.on("addrecords",function(av){var aw=av.data;S.appendData(aw)});au.on("removerecords",function(av){var aw=av.data;S.removeData(aw)});au.on("exception",function(){var av=S.get("loadMask");if(av){av.hide()}});au.on("updaterecord",function(aw){var av=aw.record;S._updateRow(av)})}},_initHeaderEvent:function(){var S=this,aA=S.get("thead"),aw=S.get("checkable"),ax=S.get("menu"),az=n.all("."+s,aA);function ay(aB){n.one(this).parent().addClass(j)}function av(aB){var aH=S._lookupByClass(aB.target,s),aJ=n.one(aB.target),aI=null,aC=null,aE=null,aD=null,aF=null,aG=null;if(!aH){return}aG=n.one(aH);aI=aG.parent();aC=aI.attr(H);aE=S._getColumnById(aC);if(aJ.hasClass(q)){aB.stopPropagation();aF=aJ.offset();if(!ax){ax=S._initMenu()}else{if(!ax.isHide()){ax.hide()}}ax.setCurrentColumn(aE);ax.setSortable(aE.sortable);ax.show({top:aF.top+24,left:aF.left})}else{if(aI.hasClass(G)){aD=aG.hasClass(V)?"DESC":"ASC";S._setSortIcon(aE.id,aD,aI,az);S.sort(aE,aD)}}}function au(aB){var aC=n.one(this).parent(),aD=aC.attr(H);aC.removeClass(j);if(ax&&!ax.isHide()&&ax.isCurrentColumn(aD)){n.one(this).parent().addClass(j)}}n.one(aA).on("click",av);az.on("mouseover",ay).on("mouseleave",au);if(aw){n.one("."+k,aA).on("click",function(){S._setAllRowsSelected(n.one(this).attr("checked"))})}},_initHeader:function(){var az=this,aB=az.get("showMenu"),au=az.get("columns"),aw=az.get("thead"),ay=aw.insertRow(0),S=az.get("checkable"),av=null,aA=null;function ax(aD){var aE=aD.sortable?G:"",aF=aE?'<span class="grid-header-sort-icon">&nbsp;</span>':"",aG=aD.hide?ak:"",aK=aB?'<span class="grid-column-menu-trigger"></span>':"",aC=aD.width,aJ=aD.cls,aI=['<th align="left" class="',af," ",aG," ",e+aD.id," ",aE,'" data-column-name="',aD.id,'" data-column-field = "',aD.dataIndex,'">','<div class ="',af,"-inner ",aJ,' "><span class="',Z,'">',aD.title,"</span>",aF,aK,"</div>","</th>"].join(""),aH=new C(aI);aH.attr("width",aC+"px");aH.appendTo(ay)}if(S){av=az._getCheckedCellTemplate("grid-header-checked-column",af);new C(av).appendTo(ay)}n.each(au,function(aD){var aC=aD.width||ah;if(!aD.id){aD.id=n.guid("col")}aD.width=aC;ax(aD)});if(!az._isAutoFitWidth()){aA=new C('<th class="'+af+' grid-header-th-empty"><div class ="'+af+'-inner"></div></th>');aA.appendTo(ay)}},_initListeners:function(){var S=this,av=S.get("listeners"),au=null;if(av){for(au in av){if(av.hasOwnProperty(au)){S.on(au,av[au])}}}},_isLastVisibleColumn:function(aw){var au=this,av=au.get("columns"),S=true;if(aw.hide){S=false}n.each(av,function(ax){if(aw!==ax&&!ax.hide){S=false;return false}});return S},_updateRow:function(au){var S=this,aw=S._findRowByRecord(au),av=S.get("columns");if(aw){n.each(av,function(aA){var aB=aA.dataIndex,aD=aA.id,ay=O+aD,ax=n.one("."+ay,aw),az=ax.one("."+o),aC=null;if(az){aC=S._getRenderText(aA,au[aB],au);aC=aC===undefined?"":aC;if(az.html()!==aC){az.html(aC);if(aA.showTip){az.attr("title",S._getShowTip(aA,au[aB],au,false))}}}})}},_setEmptyHeadCellWidth:function(aw){var S=this,av=S.get("thead"),au=n.one("."+aa,av);if(!au){return}if(aw<=0){au.hide()}else{au.attr("width",aw+"px");au.show()}},_autoSetInnerWidth:function(){var az=this,au=az.get("thead"),aw=az.get("tbody"),aA=az.get("height"),S=az._getColumnsWidth(),aB=0,ay=az._isForceFit(),ax=az.getWidth(),av=ay?R:ax<(S+2)?R:ax-(S+2);if(av>0&&av<R){av=R}az._setEmptyHeadCellWidth(av);aB=S+(av?av+2:0);n.one(au).parent().width(aB);if(aA&&!K.firefox){S-=(R+2)}n.one(aw).parent().width(S)},_initPaggingBar:function(){var aA=this,av=aA.get("gridId"),aB=aA.get("tbar"),ax=aA.get("bbar"),aC=aA.get("store"),az=0,au=null,aE=null,aD=null,aw=null;function S(aG,aH){var aF=n.merge(aG,{renderTo:aH});if(aC&&!aF.store){aF.store=aC}return new n.LP.PaggingBar(aF)}function ay(aF,aH){var aG=n.merge(aF,{renderTo:aH});return new n.LP.ButtonBar(aG)}if(aB){if(aB.pageSize){au=S(aB,av+"tbar");aA.set("tpaggingBar",au);az=aB.pageSize}if(aB.buttons){aE=ay(aB,av+"tbar");aA.set("tbuttonBar",aE)}}if(ax){aD=S(ax,av+"bbar");aA.set("bpaggingBar",aD);az=ax.pageSize}if(az&&aC){aw=aC.params;if(!aw.start){aw.start=0;aw.pageIndex=0}if(!aw.limit||aw.limit!==az){aw.limit=az}}},_initPaggingBarEvent:function(){var S=this,av=S.get("tpaggingBar"),au=S.get("bpaggingBar");if(av){av.on("beforepagechange",function(aw){S.fire("beforepagechange",aw)})}if(au){au.on("beforepagechange",function(aw){S.fire("beforepagechange",aw)})}},_isAutoFitWidth:function(){return !this.get("width")},_isForceFit:function(){var S=this,av=S.get("width"),au=S.get("forceFit");return av&&au},_isRowSelected:function(S){return n.one(S).hasClass(u)},_localSort:function(az,ay){var S=this,av=S.get("tbody"),au=S.get("store"),ax=n.makeArray(av.rows);function aw(aC,aA){var aB=F.data(aC,x);return aB?aB[aA]:""}if(au){ax.sort(function(aB,aA){var aD=F.data(aB,x),aC=F.data(aA,x);return au.compare(aD,aC)})}else{ax.sort(function(aC,aB){var aD=aw(aC,az),aA=aw(aB,az);if(aD<aA){return -ay}if(aD>aA){return ay}return 0})}n.each(ax,function(aB){var aA=n.one(aB);aA.appendTo(av)})},_rowClickEvent:function(az){var av=this,aA=av._findRow(az),au=av._findCell(az),aw=av.get("checkable"),ay=null,S=null;if(aA){ay=F.data(aA,x);if(au){S=av.fire("cellclick",{data:ay,row:aA,cell:au,field:F.attr(au,aj),domTarget:az});if(S===false){return}}av.fire("rowclick",{data:ay,row:aA});if(aw){if(!av._isRowSelected(aA)){av._setRowSelected(aA,true)}else{av._setRowSelected(aA,false)}}else{var ax=n.one("."+u,aA.parentNode);if(ax){n.all("."+u,aA.parentNode).removeClass(u);av._onRowSelectChanged(ax[0],false)}F.addClass(aA,u);av._onRowSelectChanged(aA,true)}}},_rowDoubleClickEvent:function(aw){var au=this,ax=au._findRow(aw),S=au._findCell(aw),av=null;if(ax){av=F.data(ax,x);if(S){au.fire("celldblclick",{data:av,row:ax,cell:S,field:F.attr(S,aj),domTarget:aw})}au.fire("rowdblclick",{data:av,row:ax})}},_rowOverEvent:function(au){var S=this,av=S._findRow(au);if(av){n.one(av).addClass(ao)}},_rowOutEvent:function(au){var S=this,av=S._findRow(au);if(av){n.one(av).removeClass(ao)}},_setColumnWidth:function(av,au){if(typeof(av)==="string"){av=this._getColumn(av)}var aB=this,S=av.id,ax="."+e+S,ay=".grid-body-td-"+S,az=aB.get("thead"),aw=aB.get("tbody"),aA=null;if(av.width!==au){if(au){av.width=au}else{au=av.width}n.one(ax,az).attr("width",au+"px");aA=n.all(ay,aw);aA.each(function(aC){aC.attr("width",au+"px").children(".grid-body-cell-inner").width(au)})}},_setColumnVisible:function(av,au){if(typeof(av)==="string"){av=this._getColumn(av)}if(av){var aB=this,S=av.id,aA=aB._isForceFit(),ax="."+e+S,ay=".grid-body-td-"+S,az=aB.get("thead"),aw=aB.get("tbody");if(au){av.hide=false;n.one(ax,az).removeClass(ak);n.all(ay,aw).removeClass(ak)}else{av.hide=true;n.one(ax,az).addClass(ak);n.all(ay,aw).addClass(ak)}if(aA){aB._forceFitWidth()}else{aB._autoSetInnerWidth()}}},_setHeaderChecked:function(av){var au=this,aw=au.get("thead"),S=n.one("."+k,aw);if(S){S.attr("checked",av)}},_setSortIcon:function(ay,az,au,aA){var S=this,ax=S.get("thead"),av=null,aw=null;au=au||S._getHeadCell(ay);av=n.one("."+s,au);aA=aA||n.all("."+s,ax);aw=az==="DESC"?l:V;aA.removeClass(V).removeClass(l);av.addClass(aw)},_setRowSelected:function(ay,av){var au=this,ax=F.get("."+k,ay),aw=F.data(ay,x),S=F.hasClass(ay,u);if(S===av){return}if(ax){if(F.attr(ax,"disabled")){return}ax.checked=av}if(av){F.addClass(ay,u);au._onRowSelectChanged(ay,av)}else{F.removeClass(ay,u);au._setHeaderChecked(false);au._onRowSelectChanged(ay,av)}},_onRowSelectChanged:function(aw,au){var S=this,av=F.data(aw,x);if(au){S.fire("rowselected",{data:av,row:aw})}else{S.fire("rowunselected",{data:av,row:aw})}S.fire("rowselectchanged",{data:av,row:aw,selected:au})},_setAllRowsSelected:function(av){var au=this,S=au.get("tbody");n.each(S.rows,function(aw){au._setRowSelected(aw,av)})},_setWidth:function(aw){var au=this,S=au.get("body"),ax=au.get("gridEl"),av=au._isForceFit();ax.width(aw);n.one(S).width(aw-2);ax.children(".grid-view").width(aw-2);if(av){au._forceFitWidth()}au._autoSetInnerWidth(aw);ax.addClass(d)},destroy:function(){}});function A(S){A.superclass.constructor.call(this,S);this._init()}n.extend(A,n.Base);n.augment(A,{contains:function(av){if(!av){return false}var S=this,aw=S.get("menuEl"),au=S.get("columnMenuEl");return aw[0]===av||au[0]===av||aw.contains(av)||au.contains(av)},getCurrentColumn:function(){return this.get("currentColumn")},hide:function(){var S=this,au=S.get("menuEl");au.css({visibility:"hidden"});S.hideColumnMenu();S.fire("menuhide",{column:S.getCurrentColumn()})},hideColumnMenu:function(){var S=this,au=S.get("columnMenuEl");au.css({visibility:"hidden"})},isCurrentColumn:function(av){var S=this,au=S.getCurrentColumn();if(!av||!au){return false}if(n.isObject(av)){return av===au}return av===au.id},isHide:function(){var S=this,au=S.get("menuEl");return au.css("visibility")!=="visible"},setCurrentColumn:function(au){var S=this;S.set("currentColumn",au)},setSortable:function(aw){var S=this,av=S.get("ascSortItem"),au=S.get("descSortItem");if(!aw){av.addClass(M);au.addClass(M)}else{av.removeClass(M);au.removeClass(M)}},show:function(aw){var S=this,av=S.get("menuEl"),au=S._getMenuWidth();S._resetColumnsVisible();if(!n.LP.isInHorizontalView(aw.left+au)){aw.left-=au}av.css({visibility:"visible",left:aw.left,top:aw.top});S.fire("menushow",{column:S.getCurrentColumn()})},showColumnMenu:function(aw){var S=this,av=S._getColumnMenuWidth(),au=S.get("columnMenuEl");if(!n.LP.isInHorizontalView(aw.left+av)){aw.left-=(2*av)-10}au.css({visibility:"visible",left:aw.left,top:aw.top})},_createMenuItem:function(ax,au){var S=this,aw=S.get("menuEl"),av='<div class="'+c+' "><a class="menu-item-link '+au+'" href="#">'+t+'<span class="menu-item-text">'+ax+"</span></a></div>";return new C(av).appendTo(aw)},_createColumnMenuItem:function(ay,ax){var S=this,av=ax||S.get("columnMenuEl"),az=ay.hide?y:a,au=['<div class="',ad," ",az,'"><a class="menu-item-link" href="#">'+t+'</span><span class="menu-item-text">',ay.title,"</span></a></div>"].join(""),aw=new C(au).appendTo(av);aw.data(Q,ay);return aw},_createSeperator:function(){var S=this,av=S.get("menuEl"),au='<div class="grid-menu-item-separator"></div>';return new C(au).appendTo(av)},_getMenuWidth:function(){return ag},_getColumnMenuWidth:function(){return ag},_init:function(){var S=this;S._initDom();S._initEvent()},_initDom:function(){var S=this,av='<div class="grid-menu" style = "visibility: hidden; top:-1000px;left;-1000px"></div>',au='<div class="grid-column-menu" style = "visibility: hidden; top:-1000px;left;-1000px"></div>',az=new C(av).appendTo("body"),aw=new C(au).appendTo("body"),aA=null,ay=null,ax=null;S.set("menuEl",az);S.set("columnMenuEl",aw);aA=S._createMenuItem("\u5347\u5e8f","menu-sort-asc");ay=S._createMenuItem("\u964d\u5e8f","menu-sort-desc");S._createSeperator();ax=S._createMenuItem("\u8bbe\u7f6e\u5217","menu-cols-icon");new C(t).addClass("menu-item-arrow").appendTo(ax);S.set("ascSortItem",aA);S.set("descSortItem",ay);S.set("columnItem",ax);S._initColumnMenu()},_initColumnMenu:function(){var S=this,aw=S.get("columns"),au=S.get("columnMenuEl"),av=null;n.each(aw,function(ax){S._createColumnMenuItem(ax,au)});av=au.all("."+ad);S.set("columnItems",av)},_initEvent:function(){var aB=this,ay=aB.get("menuEl"),av=aB.get("columnMenuEl"),au=aB.get("ascSortItem"),az=aB.get("descSortItem"),S=aB.get("columnItem"),aA=aB.get("columnItems");function aw(aD){var aC=n.one(this);if(!aC.hasClass(M)){aC.addClass(v)}}function ax(aD){var aC=n.one(this);aC.removeClass(v)}ay.all("."+c).on("click",function(aC){aC.preventDefault();aC.stopPropagation()}).on("mouseover",aw).on("mouseout",ax);au.on("click",function(){if(!au.hasClass(M)){aB.fire("columnsort",{column:aB.getCurrentColumn(),direction:"ASC"})}});az.on("click",function(){if(!az.hasClass(M)){aB.fire("columnsort",{column:aB.getCurrentColumn(),direction:"DESC"})}});S.on("mouseenter",function(){var aD=S.offset(),aC=S.width();aB.showColumnMenu({top:aD.top,left:aD.left+(aC-2)})}).on("mouseleave",function(aC){var aD=n.one(aC.toElement);if(aD&&!aD.hasClass("grid-column-menu")&&!av.contains(aD)){aB.hideColumnMenu()}});aA.on("click",function(aE){aE.preventDefault();aE.stopPropagation();var aD=n.one(this),aC=aD.data(Q);if(aD.hasClass(a)){aD.removeClass(a);aD.addClass(y);aB.fire("columnhide",{column:aC})}else{aD.addClass(a);aD.removeClass(y);aB.fire("columnshow",{column:aC})}}).on("mouseover",aw).on("mouseout",ax);n.one(p).on("click",function(aC){var aD=aC.target;if(!aB.isHide()&&!aB.contains(aD)){aB.hide()}})},_lookupByClass:function(au,S){if(F.hasClass(au,S)){return au}return F.parent(au,"."+S)},_resetColumnsVisible:function(){var S=this,au=S.get("columnItems");au.each(function(aw){var av=aw.data(Q);if(aw.hasClass(y)!==av.hide){if(av.hide){aw.removeClass(a);aw.addClass(y)}else{aw.addClass(a);aw.removeClass(y)}}})}});function U(S){U.superclass.constructor.call(this,S)}n.extend(U,N,{clearError:function(){var S=this;S.cancelEdit()},cancelEdit:function(){var S=this,au=S.get("columns");n.each(au,function(aw){var av=aw.editor;if(av&&!av.isHide()){av.hide()}})},hasError:function(){var au=this,S=false,av=au.get("showError"),ax=null,aw=null;if(av){aw=au.get("tbody");S=!!n.one(aw).one("."+B)}if(!S){ax=au.get("columns");n.each(ax,function(az){var ay=az.editor;if(ay&&!ay.isHide()&&ay.hasError()){S=true;return false}})}return S},setCellToEdit:function(av,ay){var au=this,ax=au._getColumn(ay),S=null,aw=null;if(ax){S=au._getCell(av,ax.id);aw=au._getEditor(ay)}if(F.hasClass(S,r)){au._showEditor(aw,S,av[ay],av)}},_attachEditEvent:function(av){var S=this,au=av.editor;au.on("change",S._getChangeEvent(av));au.on("hide",function(aw){S.set("editRecord",null);S.set("editor",null)});au.on("next",S._getNextEvent(av))},_getNextEvent:function(au){var S=this;return function(ay){var av=ay.record,az=au.dataIndex,aA=S._getNextEditCellInfo(av,az),ax=aA.cell,az=aA.field,av=aA.record,aw=null;if(ax&&F.hasClass(ax,r)){aw=S._getEditor(az);S._showEditor(aw,ax,av[az],av)}}},_getNextEditCellInfo:function(av,aw){var au=this,S=null,ay=aw,ax=null;while(av&&(!S||!au._isEditableCell(S))){ax=au._getNextEditColumn(ay);if(ax){S=au._getCell(av,ax.id);ay=ax.dataIndex}else{av=au._getNextRecord(av);ay=null}}return{cell:S,field:ay,record:av}},_getNextEditColumn:function(az){var au=this,ax=au.get("columns"),av=-1,ay=ax.length,S=null;if(az){for(var aw=0;aw<ay;aw++){if(ax[aw].dataIndex===az){av=aw;break}}}for(var aw=av+1;aw<ay;aw++){if(ax[aw].editor){S=ax[aw];break}}return S},_getNextRecord:function(au){var S=this,av=S.get("store");return av.findNextRecord(au)},_getChangeEvent:function(au){var S=this;return function(ax){var ay=ax.value,av=ax.record,az=au.dataIndex,aw=S.get("store");if(av[az]!==ay){aw.setValue(av,az,ay)}}},_addError:function(S,aw){var av=S.one("."+w),ax=S.one("."+D),au=['<span class="',D,'" title="',aw,'"></span>'].join("");if(!ax){av.addClass(B);ax=new C(au).appendTo(av)}else{ax.attr("title",aw)}},_clearError:function(S){var au=S.one("."+w),av=S.one("."+D);au.removeClass(B);if(av){av.remove()}},_clearDirtyIcons:function(){var S=this,au=S.get("tbody");n.all("."+b,au).removeClass(b)},_getEditor:function(aw){var S=this,au=S.get("columns"),av=null;n.each(au,function(ax){if(ax.dataIndex===aw){av=ax.editor;return false}});return av},_getCellTemplate:function(aA,au,aE,aG,aC){var ax=this,aK=au.dataIndex,aF=au.width,az=ax._getShowTip(au,aG,aC,true),aB=au.hide?ak:"",ay=au.editor,aw=ay?(ay.editableFun&&!ay.editableFun(aG,aC)?"":r):"",aD=aw?'<span class="x-icon x-icon-mini x-icon-success '+f+'"><i class="icon-ok icon-white icon-pencil"></i></span>':"",av=ax.get("showError"),S=av?(ay&&ay.getError(aG,aC)):"",aH=S?'<span class="'+D+' x-icon x-icon-mini x-icon-error" title="'+S+'">\u00d7</span>':"",aI=S?B:"",aJ=['<td  class="grid-body-cell grid-body-td-',au.id," ",aB," ",aw,'" data-column-name="',au.id,'" colindex="',aA,'" data-column-field = "',aK,'" width="',aF,'px">','<div class="',w," ",aI,'" style="width : ',aF,'px"><span class="',o,' " ',az,">",aE,"</span>",aH,aD,"</div></td>"].join("");return aJ},_getRowDataByCell:function(au){var S=this,aw=S._findRow(au),av=F.data(aw,x);return av},_getCellValue:function(au,ax){var S=this,ay=S._findRow(au),aw=F.data(ay,x),av=aw?aw[ax]:null;return av},_hasEditor:function(S){return this.hasAttr(ar+S)},_hideEditor:function(S){S.css({visibility:"hidden",left:-10000,top:-10000})},_isEditableCell:function(S){return F.hasClass(S,r)},_init:function(){U.superclass._init.call(this);var S=this,au=S.get("columns");n.each(au,function(aw){var av=aw.editor,ax=null;if(!av||av.isEditor){return}ax=an.types[av.type||"text"];aw.editor=new ax(av);S._attachEditEvent(aw)})},_initEvent:function(){var S=this;n.Event.on(p,"click",function(ax){var aw=S.get("editor"),av=ax.target,au=S._findCell(ax.target);if(!au&&aw&&!aw.isHide()&&!aw.hasError()&&!aw.isContains(av)){aw.hide()}});S.constructor.superclass._initEvent.call(S)},_initDataEvent:function(){var S=this,au=S.get("store");au.on("updaterecord",function(aw){var av=aw.record;S._setRowValue(av,aw.field)});S.on("rowremoved",function(ax){var av=S.get("editRecord"),aw=S.get("editor");if(av&&aw){if(av===ax.data&&!aw.isHide()){aw.hide()}}});au.on("acceptchanges",function(av){S._clearDirtyIcons()});S.constructor.superclass._initDataEvent.call(this)},_rowClickEvent:function(aA){var av=this,au=av._findCell(aA),az=null,ax=null,ay=null,S=null,aw=null;if(au){az=F.attr(au,aj);ax=av._getEditor(az);ay=av.get("editor");if(ay&&ay!==ax){if(!ay.isHide()&&!ay.hasError()){ay.hide()}}if(az&&ax){if(!ax.isHide()&&ax.hasError()){ax._focus();return}aw=av._getRowDataByCell(au);if(aw){if(!av._isEditableCell(au)){return}S=av.fire("beforeedit",{cell:au,field:az,data:aw,editor:ax});if(S!==false){av._showEditor(ax,au,aw[az],aw)}}return}}av.constructor.superclass._rowClickEvent.call(this,aA)},_setRowValue:function(aw,av){var S=this,ax=S._findRowByRecord(aw),au=S.get("columns");if(ax){n.each(au,function(az){var aC=az.dataIndex,ay=az.id,aF=O+ay,aD=n.one("."+aF,ax),aH=aD.one("."+o),aB=az.editor,aG=aB&&aB.getError(aw[aC],aw),aE=null,aA=S.get("showError");if(aH){if(av===aC){aD.addClass(b)}aE=S._getRenderText(az,aw[aC],aw);aE=aE===undefined?"":aE;aH.html(aE);if(az.showTip){aH.attr("title",S._getShowTip(az,aw[aC],aw,false))}if(!aA){return}if(aG){S._addError(aD,aG)}else{S._clearError(aD)}}})}},_showEditor:function(ax,aA,az,aw){var ay=this,av=F.offset(aA),aC=F.get("."+w,aA),S=F.width(aC),aB=F.height(aC),au=ay.get("editor");if(au&&!au.isHide()&&!au.hasError()){au.hide()}ay.set("editRecord",aw);ay.set("editor",ax);if(K.ie===6){ax.setWidth(S-12)}else{ax.setWidth(S-10)}ax.setValue(az,aw);ax.show({container:aC,left:0,top:2})}});function an(au){var S=this;au=n.merge({isEditor:true},au);n.mix(S,au);an.superclass.constructor.call(S,au);S._init();S.events=["beforechange","change"]}n.extend(an,n.Base);n.augment(an,{CHANGE_EVENT:"blur",INIT_VALUE:"",set:function(S,au){an.superclass.set.call(this,S,au,{silent:1})},hasError:function(){var S=this,au=S.get("el");return au.hasClass(ai)},hide:function(){var S=this,au=S.get("el");S._clearError();au.css({visibility:"hidden",left:-10000,top:-10000});S.fire("hide",{record:S.get("record"),editor:S});S._setValue(S.INIT_VALUE);n.one("body").append(au)},getValue:function(){var S=this,au=S.get("editEl");return au?S._getValue():S.INIT_VALUE},isHide:function(){var S=this,au=S.get("el");return au.css("visibility")==="hidden"},isContains:function(au){var S=this,av=S.get("el");return av.contains(au)},setValue:function(aw,au){var S=this,av=S.get("editEl");S.set("record",au);if(av){S._setValue(aw);S._validate(aw,au)}},show:function(aw){var S=this,av=S.get("el"),au=aw.container;if(au){n.one(au).append(av)}av.css({visibility:"visible",left:aw.left,top:aw.top});S._focus();S.fire("show",{record:S.get("record"),editor:S})},setWidth:function(av){var S=this,au=S.get("editEl");au.width(av)},setHeight:function(au){var S=this,av=S.get("editEl");av.height(au)},_basicValidator:function(au,av){var S=this;if(S.required&&(au===undefined||au===null||n.trim(au.toString())==="")){return"\u4e0d\u80fd\u4e3a\u7a7a"}return""},_basicFormat:function(S){if(S===undefined||n.trim(S.toString())===""){return undefined}return S},_clearError:function(){var S=this,au=S.get("el"),av=au.one("."+z);au.removeClass(ai);av.attr("title","")},_focus:function(){var S=this,au=S.get("editEl");au[0].focus()},_getTemplate:function(){var S=['<input type="text" name=""autocomplete="off" size="20" class="control-text lp-editor-field">'].join("");return S},_getErrorIconTpl:function(){return'<span class="x-icon '+z+' x-icon-mini x-icon-error">\u00d7</span>'},_getEditElemnt:function(){var S=this,au=S.get("el");return n.one(au[0].firstChild)},_getValue:function(au){var S=this;au=au||S.get("editEl");return au.val()},_init:function(){var S=this;S._initDom();S._initPreventEvent();S._initEvent();S._initKeyEvent()},_initDom:function(){var S=this,ax=null,aw=null,av=['<div class="grid-editor" style="position : absolute; z-index : 1000; visibility : hidden; left : -10000px; top : -10000px; overflow : auto;">',S._getTemplate(),S._getErrorIconTpl(),"</div>"].join(""),au=S.get("container")||F.get("body");ax=new C(av).appendTo(au);S.set("container",au);S.set("el",ax);aw=S._getEditElemnt();S.set("editEl",aw)},_initEvent:function(){var S=this,av=S.get("el"),au=S.get("editEl");av.on("click",function(aw){aw.stopPropagation()});au.on(S.CHANGE_EVENT,function(ay){if(!S.isHide()){var aw=n.one(this),ax=S._valueChange(aw);if(!ax){ay.preventDefault()}}})},_initPreventEvent:function(){var S=this,au=S.get("el");au.on("click",function(av){av.stopPropagation()})},_initKeyEvent:function(){var S=this,au=S.get("editEl");au.on("keydown",function(av){var aw=av.keyCode;switch(aw){case J:S._keyEnterEvent(au);break;case h:S._keyCancelEditEvent();break;case W:av.halt();S._keyTabEvent(au);break;default:break}})},_keyEnterEvent:function(S){this._completeEdit(S)},_keyCancelEditEvent:function(){var S=this;S.hide()},_keyTabEvent:function(au){var S=this,av=S._completeEdit(au);if(av){S.fire("next",{record:S.get("record")})}},_completeEdit:function(au){var S=this,av=S._valueChange(au);if(av){S.hide()}return av},_valueChange:function(av,ax){var S=this,au=S.get("record"),aw=null;ax=ax||S._getValue(av);aw=S._validate(ax,au);ax=S._basicFormat(ax);ax=S.format?S.format(ax):ax;if(aw){S.fire("change",{value:ax,record:au});return true}return false},_setError:function(av){var S=this,au=S.get("el"),aw=au.one("."+z);au.addClass(ai);aw.attr("title",av)},_setValue:function(av,au){var S=this;au=au||S.get("editEl");au.val(av)},getError:function(S,au){return this._basicValidator(S)||(this.validator&&this.validator(S,au))},_validate:function(aw,ax){var au=this,S=null,av=true;S=au.getError(aw,ax);av=S?false:true;if(av){au._clearError()}else{au._setError(S)}return av},destroy:function(){var S=this,au=S.get("el");au.remove();S.detach();S.__attrVals={}}});function aq(S){aq.superclass.constructor.call(this,S)}n.extend(aq,an);n.augment(aq,{_basicFormat:function(S){if(S){S=S.replace(/</g,"&lt;").replace(/>/,"&gt;").replace(/\"/,"&quot;")}return S},_setValue:function(au,S){if(au){au=au.replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"')}this.constructor.superclass._setValue.call(this,au,S)}});function am(S){am.superclass.constructor.call(this,S)}n.extend(am,an);n.augment(am,{_basicFormat:function(S){if(S===undefined||n.trim(S.toString())===""){return undefined}return parseFloat(S)},_basicValidator:function(S){var au=this.constructor.superclass._basicValidator.call(this,S);if(!au&&S&&isNaN(S)){au="\u8bf7\u8f93\u5165\u6570\u5b57"}return au}});function E(S){E.superclass.constructor.call(this,S)}n.extend(E,an);n.augment(E,{CHANGE_EVENT:"change",INIT_VALUE:false,setHeight:function(S){return},_getTemplate:function(){var S=['<input type="checkbox" name="" class="lp-form-checkbox-field lp-editor-field">'].join("");return S},_getValue:function(S){S=S||this.get("editEl");var au=S.attr("checked");return au?true:false},_setValue:function(av,au){var S=this;au=au||S.get("editEl");au.attr("checked",av)}});function m(S){m.superclass.constructor.call(this,S)}n.extend(m,an);n.augment(m,{setWidth:function(S){this.constructor.superclass.setWidth.call(this,S+9)},_getTemplate:function(){var S=['<select class="lp-form-select-field lp-editor-field" tabindex="1" id="sel',n.guid(),'" ></select>'].join("");return S},_initDom:function(){this.constructor.superclass._initDom.call(this);var S=this,av=S.get("editEl"),au=S.items,aw=null;if(!S.required){S._createItem("\u8bf7\u9009\u62e9",S.INIT_VALUE,av)}if(n.isArray(au)){n.each(au,function(ax){S._createItem(ax.name,ax.value,av)})}else{for(aw in au){if(au.hasOwnProperty(aw)){S._createItem(au[aw],aw,av)}}}},_createItem:function(av,aw,S){var au='<option value="'+aw+'">'+av+"</option>";new C(au).appendTo(S)}});function ac(S){ac.superclass.constructor.call(this,S)}n.extend(ac,an);n.augment(ac,{CHANGE_EVENT:"change",_basicValidator:function(au){var S=this;validText=this.constructor.superclass._basicValidator.call(this,au);if(!validText&&au&&!S._isDate(au)){validText="\u4e0d\u662f\u6709\u6548\u7684\u65e5\u671f\u683c\u5f0f\uff01"}return validText},_isDate:function(S){if(n.isNumber(S)){return true}if(n.isString(S)){S=Date.parse(S.replace(/-/g,"/"))}return n.isNumber(S)&&!isNaN(S)},_validate:function(aw,ax){var au=this,S=null,av=true;S=au._basicValidator(aw)||(au.validator&&au.validator(au._basicFormat(aw),ax));av=S?false:true;if(av){au._clearError()}else{au._setError(S)}return av},isContains:function(au){var S=this;return S.constructor.superclass.isContains.call(this,au)||n.one(au).parent(".ks-cal-box")},hide:function(){var S=this,au=S.get("datepicker");au.hide();S.constructor.superclass.hide.call(this)},setHeight:function(){return},setWidth:function(S){this.constructor.superclass.setWidth.call(this,S-6)},_basicFormat:function(S){if(n.isString(S)){S=S.replace(/-/g,"/")}return new Date(S).getTime()},_getTemplate:function(){var S=['<input type="text" name=""autocomplete="off" size="20" style="height:18px" class="control-text lp-editor-field">'].join("");return S},_init:function(){var S=this;if(S.showTime){}n.use("lpassert/calendar",function(au,av){S.set("Calendar",av);S.constructor.superclass._init.call(S)})},_initDom:function(){this.constructor.superclass._initDom.call(this);var S=this,au=S.get("editEl"),aw=S.get("Calendar"),ax="grid-date"+n.guid(),av=null;au.attr("id",ax);av=new aw([{selector:"#"+ax,showTime:S.showTime,allowEdit:true}]);S.set("datepicker",av["#"+ax])},_setValue:function(ax,aw){var S=this,au=S.showTime?n.LP.Format.datetimeRenderer(ax):n.LP.Format.dateRenderer(ax),av=S.get("datepicker");aw=aw||S.get("editEl");aw.val(au);if(ax&&ax!==S.INIT_VALUE){av.render({selected:new Date(ax),date:new Date(ax)})}}});function al(S){al.superclass.constructor.call(this,S)}n.extend(al,an);n.augment(al,{hide:function(){var S=this;if(S._isSelectShow()){S._hideSelect()}S.constructor.superclass.hide.call(this)},isContains:function(au){var S=this;return S.constructor.superclass.isContains.call(this,au)||n.one(au).parent(".lp-multiple-wrap")},setValue:function(av,au){var S=this;av=av||[];S.constructor.superclass.setValue.call(this,av,au)},setHeight:function(){return},_createItem:function(aw,av,S){var au='<li class="multiple-item"> <input class="multiple-item-checkbox"  type="checkbox" name="'+av+'" />'+aw+"</li>";new C(au).appendTo(S)},_getSelectOffset:function(){var S=this,au=S.get("editEl"),av=au.offset();av.top+=au.height()+2;return av},_getText:function(aw){var S=this,au=S.items,av=S.get("renderer");aw=aw||S._getValue();if(!av){av=n.LP.Format.multipleItemsRenderer(au);S.set("renderer",av)}return av(aw)},_getValue:function(){var S=this,av=[],aw=S.get("listEl"),au=aw.all(".multiple-item-checkbox");n.each(au,function(ax){if(ax.checked){av.push(ax.name)}});return av},_getTemplate:function(){var S=['<input type="text" readonly = "true" name=""autocomplete="off" size="20" class="lp-form-multiple-field control-text lp-editor-field" >'].join("");return S},_hideSelect:function(){var S=this,au=S.get("selectEl");au.css({visibility:"hidden",left:-10000,top:-10000})},_isSelectShow:function(){var S=this,au=S.get("selectEl");return au.css("visibility")!=="hidden"&&au.width()!==0},_initDom:function(az){this.constructor.superclass._initDom.call(this);var S=this,av=S.get("items"),au='<div class="lp-multiple-wrap"  style="position : absolute; z-index : 1200; visibility : hidden; left : -10000px; top : -10000px; overflow : auto;"><ul class="multiple-list ks-clear"></ul><div class="multiple-footer" style="text-align:center"><span class="x-btn x-btn-default-small"><button class="button button-small" autocomplete="off" hidefocus="true" type="button"><span class="x-btn-inner">\u786e\u8ba4</span></button></span></div></div>',aw=new C(au).appendTo("body"),ay=aw.one(".multiple-list"),ax=aw.one("button"),aA=null;S.set("selectEl",aw);S.set("listEl",ay);S.set("btnEl",ax);if(n.isArray(av)){n.each(av,function(aB){S._createItem(aB.name,aB.value,ay)})}else{for(aA in av){if(av.hasOwnProperty(aA)){S._createItem(av[aA],aA,ay)}}}},_initEvent:function(){var S=this,aw=S.get("listEl"),au=S.get("editEl"),av=S.get("btnEl");au.on("click",function(ax){ax.stopPropagation();S._toggleSelect()});aw.on("click",function(ax){ax.stopPropagation()});av.on("click",function(ax){ax.stopPropagation();var ay=S.getValue();S._setText(S._getText(ay));S._hideSelect();S._valueChange(au,ay)})},_setText:function(av){var S=this,au=S.get("editEl");au.val(av)},_setSelectValue:function(av){var S=this,aw=S.get("listEl"),au=aw.all(".multiple-item-checkbox"),ax=null;au.attr("checked",false);ax=n.filter(au,function(ay){return n.inArray(ay.name,av)});n.all(ax).attr("checked","checked")},_setValue:function(au){var S=this,av=S._getText(au);S._setText(av);S._setSelectValue(au)},_showSelect:function(au){var S=this,av=S.get("selectEl");au=au||S._getSelectOffset();av.css({visibility:"visible",left:au.left,top:au.top})},_toggleSelect:function(){var S=this;if(S._isSelectShow()){S._hideSelect()}else{S._showSelect()}}});an.types={text:aq,number:am,check:E,select:m,date:ac,multipleSelect:al};n.namespace("LP");n.LP.Grid=N;n.LP.EditGrid=U},{requires:["core","./uicommon","./bar"]});
