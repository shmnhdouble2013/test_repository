KISSY.add(function(h){var q=h.DOM,p=h.Event;var k="list-button-left",l="list-button-right",o="list-search-input",f="list-search-tip",c="list-i",a="list-more",i="list-selected",e="list-inner-inner",m="list-button-active",d="list-result-con",g="list-u",j=['<div class="list-container ks-clear">','<div class="list-left">','<s class="list-button list-button-left"></s>',"</div>",'<div class="list-inner">','<div class="list-inner-inner">',"</div>","</div>",'<div class="list-right">','<s class="list-button list-button-right"></s>',"</div>","</div>",'<div class="list-result">',"<strong>\u60a8\u5f53\u524d\u7684\u9009\u62e9: </strong>",'<span class="list-result-con"></span>',"</div>"].join(""),b=['<div class="list-item">','<div class="list-search">','<input type="text" class="list-search-input"/>','<p class="list-search-tip"></p>',"</div>",'<ul class="list-u">',"</ul>","</div>"].join("");function n(s){var r=this;s=h.merge(n.config,s);n.superclass.constructor.call(r,s);r._init()}n.config={searchTip:""};h.extend(n,h.LP.TreeBase);h.augment(n,{_init:function(){var s=this,t=s.get("container"),v,u,w,r;t[0].innerHTML=j;v=h.one("."+e,t);u=h.get("."+d,t);w=h.one("."+k,t);r=h.one("."+l,t);s.set("listsCon",v);s.set("resultCon",u);s.set("leftBtn",w);s.set("rightBtn",r);s.set("listWidth",215);s.set("containerWidth",860);s._initListTree();s._initEvent()},_initEvent:function(){var s=this,t=s.get("container"),u=s.get("leftBtn"),r=s.get("rightBtn");s.on("resultUpdate",function(v){s._updateResultCon()});u.on("click",function(){if(q.hasClass(this,m)){s._roll("left")}});r.on("click",function(){if(q.hasClass(this,m)){s._roll("right")}});s.on("pushList popList",function(){s._resetListConWidth();s._rollManage(function(){if(s._isRoll()){s._roll("last")}})});s.on("beforeDestroy",function(){s._destroy()})},_initListDom:function(v,t){var r=this,s=q.create(b),u=r.get("listsCon");u.append(s);v.itemsCon=h.one("."+g,s);v.searchInput=h.one("."+o,s);v.searchTip=h.one("."+f,s);v.searchInput.data("index",t);v.searchTip.text(r.get("searchTip"));return h.one(s)},_initListEvent:function(s){var r=this,t;s.searchTip.on("click",function(){h.one(this).hide().prev()[0].focus()});s.searchInput.on("focus",function(){h.one(this).next("."+f).hide()});s.searchInput.on("blur",function(){var u=h.one(this),v=u.next("."+f);if(!!u.val()){v.hide()}else{v.show()}});s.searchInput.on("keyup",function(v){if(v.which===32||v.which===8||v.which===46||(v.which>=65&&v.which<=90)||(v.which>=48&&v.which<=57)||(v.which>=96&&v.which<=105)){var u=h.one(this);if(t){t.cancel()}t=h.later(function(){r._searchList(u.val(),u.data("index"))},200)}});s.searchInput.on("keydown",function(u){if(u.which===13){return false}})},_initListItemsDom:function(v,s,u,r,y){var t=c,x=s.value,z,w;if(!s.isleaf){t+=(" "+a)}if(y){x=x.replace(y,"<s>"+y+"</s>")}z=['<li class="',t,'">',x,"</li>"].join("");w=q.create(z);v.itemsCon.append(w);w=h.one(w);return w},_initListItemsEvent:function(s){var r=this;s.on("click",function(){r._itemChangeSelect(h.one(this))})},_getItems:function(r){return h.all("."+c,r.dom)},_isItemSelect:function(r){return r.hasClass(i)},_addItemSelect:function(r){r.addClass(i)},_removeItemSelect:function(r){r.removeClass(i)},_removeAllSelectByItem:function(r){r.siblings().removeClass(i)},_removeAllSelectByList:function(t){var r=this,s=r._getItems(t);s.removeClass(i)},_updateResultCon:function(){var r=this;r.get("resultCon").innerHTML=r.getValueStrFromResult()},_roll:function(t){var s=this,x=s.get("listsCon"),y=s.get("listWidth"),r=s.get("listConWidth"),w=s.get("containerWidth"),u=x.css("left").replace("px","")*1||0;var v=function(A,B){var z=u+A*B;z=z>0?0:w-r-z>0?w-r:z;s._rollAnim(z,function(){s._resetRollBtn()}).run()};if(t==="left"){v(1,y)}else{if(t==="right"){v(-1,y)}else{if(t=="last"){v(1,w-u-r)}else{if(t.target&&t.distance){v(t.target,t.distance)}}}}},_rollManage:function(s){var r=this,t=r.get("rollTimer");if(t){t.cancel()}t=h.later(s,200);r.set("rollTimer",t)},_rollAnim:function(t,s){var r=this;return h.Anim(r.get("listsCon"),{left:t+"px"},0.2,"easeOut",s)},_resetListConWidth:function(){var s=this,t=s.get("listsCon"),u=s.get("listWidth"),r=t.children().length*u;t.width(r+"px");s.set("listConWidth",r);return s},_resetRollBtn:function(){var s=this,v=s.get("listsCon"),r=s.get("listConWidth"),u=s.get("containerWidth"),t=v.css("left").replace("px","")*1||0;rightBtn=s.get("rightBtn"),leftBtn=s.get("leftBtn");if(r+t-u>0){rightBtn.addClass(m)}else{rightBtn.removeClass(m)}if(t<0){leftBtn.addClass(m)}else{leftBtn.removeClass(m)}},_isRoll:function(){var s=this,v=s.get("listsCon"),r=s.get("listConWidth"),u=s.get("containerWidth"),t=v.css("left").replace("px","")*1||0;s._resetRollBtn();if(u-t-r!==0){return true}return false},_destroy:function(){var s=this,t=s.get("leftBtn"),r=s.get("rightBtn");t.detach().remove();r.detach().remove()}});h.namespace("LP");h.LP.ListTree=n},{requires:["lpmodule/treebase","lpmodule/css/module.css"]});
